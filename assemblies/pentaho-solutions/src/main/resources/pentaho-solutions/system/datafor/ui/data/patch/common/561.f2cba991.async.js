(self["webpackChunkdataforui_common"]=self["webpackChunkdataforui_common"]||[]).push([[561],{13750:function(t,e){"use strict";e.Tf=e.Bc=e.jp=e.fL=e.O6=e.rC=void 0,e.rC="l7plot-legend l7plot-legend__category",e.O6="l7plot-legend__title",e.fL="l7plot-legend__category-list",e.jp="l7plot-legend__list-item",e.Bc="l7plot-legend__category-marker",e.Tf="l7plot-legend__category-value",'<div class="'.concat(e.rC,'">\n  <div class="').concat(e.O6,'"></div>\n  <ul class="').concat(e.fL,'"></ul>\n</div>'),'<li class="'.concat(e.jp,'" data-index={index}>\n  <span class="').concat(e.Bc,'" style="background:{color}"></span>\n  <span class="').concat(e.Tf,'">{value}</span>\n</li>')},42814:function(t,e){"use strict";e.VI=e.bl=e.el=e.I8=e.O6=e.rC=void 0,e.rC="l7plot-legend l7plot-legend__continue",e.O6="l7plot-legend__title",e.I8="l7plot-legend__ribbon-container",e.el="l7plot-legend__ribbon",e.bl="l7plot-legend__gradient-bar",e.VI="l7plot-legend__value-range",'<div class="'.concat(e.rC,'">\n  <div class="').concat(e.O6,'"></div>\n  <div class="').concat(e.I8,'"></div>\n</div>'),'<div class="'.concat(e.el,'">\n  <span class="').concat(e.VI,'">{min}</span>\n  <div class="').concat(e.bl,'" style="background-image: {backgroundImage}"></div>\n  <span class="').concat(e.VI,'">{max}</span>\n</div>')},86732:function(t,e){"use strict";e.Tf=e.bX=e.jp=e.fL=e.O6=e.rC=void 0,e.rC="l7plot-tooltip",e.O6="l7plot-tooltip__title",e.fL="l7plot-tooltip__list",e.jp="l7plot-tooltip__list-item",e.bX="l7plot-tooltip__name",e.Tf="l7plot-tooltip__value",'<div class="'.concat(e.rC,'">\n  <div class="').concat(e.O6,'"></div>\n  <ul class="').concat(e.fL,'"></ul>\n</div>'),'<li class="'.concat(e.jp,'" data-index={index}>\n  <span class="').concat(e.bX,'">{name}</span>\n  <span class="').concat(e.Tf,'">{value}</span>\n</li>')},83561:function(t,e,o){"use strict";o.r(e),o.d(e,{ArcLayer:function(){return dn},Area:function(){return Sn},AreaLayer:function(){return xn},BaseMapType:function(){return jt},Choropleth:function(){return Vn},Dot:function(){return Ao},DotDensity:function(){return Po},DotDensityLayer:function(){return _o},DotLayer:function(){return zo},Flow:function(){return fn},Grid:function(){return Xo},GridLayer:function(){return Yo},Heatmap:function(){return Ko},HeatmapLayer:function(){return Vo},Hexbin:function(){return nn},HexbinLayer:function(){return on},IconLayer:function(){return Kn},L7Plot:function(){return oi},LayerType:function(){return At},LineStyleType:function(){return zt},Map:function(){return Je},Path:function(){return yn},PathLayer:function(){return un},Plot:function(){return co},PlotType:function(){return Ht},PrismLayer:function(){return $n},TextLayer:function(){return lo},TooltipAnchorType:function(){return Gt.anchorType},getTheme:function(){return Zt},registerFontFace:function(){return p},registerIconFont:function(){return y},registerIconFonts:function(){return h},registerImage:function(){return r},registerImages:function(){return a},registerTheme:function(){return Nt},unregisterFontFace:function(){return c},unregisterIconFont:function(){return d},unregisterImage:function(){return s},version:function(){return n}});var n="0.5.6",i=new Map;function r(t,e){i.set(t,e)}function a(t){t.forEach((function(t){i.set(t.id,t.image)}))}function s(t){return i.delete(t)}var l=new Map;function p(t,e){l.set(t,e)}function c(t){return l.delete(t)}var u=new Map;function y(t,e){u.set(t,e)}function h(t){t.forEach((function(t){u.set(t.name,t.fontUnicode)}))}function d(t){return u.delete(t)}var f={}.toString,m=function(t,e){return f.call(t)==="[object "+e+"]"},v=m,g=function(t){return v(t,"Function")},L=function(t){return Array.isArray?Array.isArray(t):v(t,"Array")},C=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function b(t,e){var o;if(t)if(L(t)){for(var n=0,i=t.length;n<i;n++)if(o=e(t[n],n),!1===o)break}else if(C(t))for(var r in t)if(t.hasOwnProperty(r)&&(o=e(t[r],r),!1===o))break}var D=b;Object.keys;var x=function(t){return"object"===typeof t&&null!==t},S=x,F=function(t){if(!S(t)||!v(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;var e=t;while(null!==Object.getPrototypeOf(e))e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},O=F;var w=Array.prototype,k=(w.splice,w.indexOf,Array.prototype.splice,function(t){return v(t,"String")});Object.prototype.hasOwnProperty;var T=function(t){return v(t,"Number")},E=T,I=(Number.isInteger&&Number.isInteger,Math.PI,parseInt,Math.PI,Object.values?function(t){return Object.values(t)}:function(t){var e=[];return D(t,(function(o,n){g(t)&&"prototype"===n||e.push(o)})),e}),B=I,z=function(t){return null===t||void 0===t},A=z,j=function(t){return A(t)?"":t.toString()},H=function(t){return j(t).toLowerCase()},_=H;function P(t,e){return t&&e?t.replace(/\\?\{([^{}]+)\}/g,(function(t,o){return"\\"===t.charAt(0)?t.slice(1):void 0===e[o]?"":e[o]})):t}var M=P,Z=function(t){return v(t,"Boolean")},N=Z;Object.prototype;var G=function(t){return void 0===t},R=G,V=function(t){if("object"!==typeof t||null===t)return t;var e;if(L(t)){e=[];for(var o=0,n=t.length;o<n;o++)"object"===typeof t[o]&&null!=t[o]?e[o]=V(t[o]):e[o]=t[o]}else for(var i in e={},t)"object"===typeof t[i]&&null!=t[i]?e[i]=V(t[i]):e[i]=t[i];return e},K=V,U=function(t,e){if(!g(t))throw new TypeError("Expected a function");var o=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=e?e.apply(this,n):n[0],a=o.cache;if(a.has(r))return a.get(r);var s=t.apply(this,n);return a.set(r,s),s};return o.cache=new Map,o},W=5;function Q(t,e,o,n){for(var i in o=o||0,n=n||W,e)if(e.hasOwnProperty(i)){var r=e[i];null!==r&&O(r)?(O(t[i])||(t[i]={}),o<n?Q(t[i],r,o+1,n):t[i]=e[i]):L(r)?(t[i]=[],t[i]=t[i].concat(r)):void 0!==r&&(t[i]=r)}}var q=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var n=0;n<e.length;n+=1)Q(t,e[n]);return t},Y=q;Object.prototype.hasOwnProperty;var X=function(t){return null!==t&&"function"!==typeof t&&isFinite(t.length)},$=X,J=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(k(t)||k(e))return!1;if($(t)||$(e)){if(t.length!==e.length)return!1;for(var o=!0,n=0;n<t.length;n++)if(o=J(t[n],e[n]),!o)break;return o}if(S(t)||S(e)){var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(o=!0,n=0;n<i.length;n++)if(o=J(t[i[n]],e[i[n]]),!o)break;return o}return!1},tt=J,et=function(t,e,o){var n=0,i=k(e)?e.split("."):e;while(t&&n<i.length)t=t[i[n++]];return void 0===t||n<i.length?o:t},ot=Object.prototype.hasOwnProperty,nt=function(t,e){if(null===t||!O(t))return{};var o={};return D(e,(function(e){ot.call(t,e)&&(o[e]=t[e])})),o},it={},rt=function(t){return t=t||"g",it[t]?it[t]+=1:it[t]=1,t+it[t]},at=function(t,e){return at=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},at(t,e)};function st(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}at(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}var lt=function(){return lt=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},lt.apply(this,arguments)};function pt(t,e){var o={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(o[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(o[n[i]]=t[n[i]])}return o}function ct(t,e,o,n){function i(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,r){function a(t){try{l(n.next(t))}catch(e){r(e)}}function s(t){try{l(n["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):i(t.value).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function ut(t,e){var o,n,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return l([t,e])}}function l(r){if(o)throw new TypeError("Generator is already executing.");while(a)try{if(o=1,n&&(i=2&r[0]?n["return"]:r[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}Object.create;function yt(t,e){var o="function"===typeof Symbol&&t[Symbol.iterator];if(!o)return t;var n,i,r=o.call(t),a=[];try{while((void 0===e||e-- >0)&&!(n=r.next()).done)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(o=r["return"])&&o.call(r)}finally{if(i)throw i.error}}return a}function ht(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,i++)n[i]=r[a];return n}var dt;Object.create;U((function(t,e){void 0===e&&(e={});var o=e.fontSize,n=e.fontFamily,i=e.fontWeight,r=e.fontStyle,a=e.fontVariant;return dt||(dt=document.createElement("canvas").getContext("2d")),dt.font=[r,a,i,o+"px",n].join(" "),dt.measureText(k(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),ht([t],B(e)).join("")})),function(){function t(){this.map={}}t.prototype.has=function(t){return void 0!==this.map[t]},t.prototype.get=function(t,e){var o=this.map[t];return void 0===o?e:o},t.prototype.set=function(t,e){this.map[t]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(t){delete this.map[t]},t.prototype.size=function(){return Object.keys(this.map).length}}();var ft=o(86732),mt=o(13750),vt=o(42814);function gt(t){var e,o,n,i={point:{default:{fill:t.pointFillColor,size:t.pointSize,stroke:t.pointBorderColor,lineWidth:t.pointBorder,fillOpacity:t.pointFillOpacity},active:{fill:t.pointActiveFillColor},selected:{fill:t.pointSelectedFillColor}}};return{mapStyle:t.mapStyle,defaultColor:t.brandColor,subColor:t.subColor,semanticRed:t.paletteSemanticRed,semanticGreen:t.paletteSemanticGreen,fontFamily:t.fontFamily,colors10:t.paletteQualitative10,colors20:t.paletteQualitative20,sequenceColors:t.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:i.point.default},active:{style:i.point.active},selected:{style:i.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:(e={},e[mt.rC]={visibility:"visible",zIndex:1,backgroundColor:t.legendContainerFillColor,boxShadow:t.legendContainerShadow,borderRadius:"".concat(t.legendContainerBorderRadius,"px"),color:t.legendTextFillColor,fontFamily:t.fontFamily,padding:"10px",lineHeight:"1",fontSize:"".concat(t.legendTextFontSize,"px")},e[mt.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},e[mt.fL]={margin:"0px",padding:"0px"},e[mt.jp]={marginBottom:"2px"},e[mt.Bc]={width:"10px",height:"10px"},e[mt.Tf]={paddingLeft:"8px"},e)},continue:{domStyles:(o={},o[vt.rC]={visibility:"visible",zIndex:1,backgroundColor:t.legendContainerFillColor,boxShadow:t.legendContainerShadow,borderRadius:"".concat(t.legendContainerBorderRadius,"px"),color:t.legendTextFillColor,fontFamily:t.fontFamily,padding:"10px",lineHeight:1,fontSize:"".concat(t.legendTextFontSize,"px")},o[vt.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},o[vt.el]={display:"flex",alignItems:"center"},o[vt.bl]={width:"140px",height:"14px",margin:"0px 5px"},o[vt.VI]={padding:"0px"},o)}},tooltip:{domStyles:(n={},n[ft.rC]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:t.tooltipContainerFillColor,boxShadow:t.tooltipContainerShadow,borderRadius:"".concat(t.tooltipContainerBorderRadius,"px"),color:t.tooltipTextFillColor,fontSize:"".concat(t.tooltipTextFontSize,"px"),fontFamily:t.fontFamily,lineHeight:t.tooltipTextLineHeight},n[ft.O6]={marginBottom:"4px"},n[ft.fL]={margin:"0px",padding:"0px"},n[ft.jp]={marginBottom:"4px"},n[ft.bX]={color:t.tooltipItemNameFillColor},n[ft.Tf]={color:t.tooltipItemValueFillColor,marginLeft:"30px"},n)},label:{style:{textAnchor:"center",textOffset:[0,0],fill:t.labelFillColor,fontSize:t.labelFontSize,fontFamily:t.fontFamily,fillColorDark:t.labelFillColorDark,fillColorLight:t.labelFillColorLight}}}}}var Lt={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Ct={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},bt=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],Dt=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],xt=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],St=function(t){void 0===t&&(t={});var e=t.mapStyle,o=void 0===e?"light":e,n=t.subColor,i=void 0===n?"rgba(0,0,0,0.05)":n,r=t.paletteQualitative10,a=void 0===r?bt:r,s=t.paletteQualitative20,l=void 0===s?Dt:s,p=t.paletteSemanticRed,c=void 0===p?"#F4664A":p,u=t.paletteSemanticGreen,y=void 0===u?"#30BF78":u,h=t.paletteSemanticYellow,d=void 0===h?"#FAAD14":h,f=t.paletteSequence,m=void 0===f?xt:f,v=t.fontFamily,g=void 0===v?'"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,\n    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",\n    "Noto Color Emoji"':v,L=t.brandColor,C=void 0===L?a[0]:L;return{mapStyle:o,brandColor:C,subColor:i,paletteQualitative10:a,paletteQualitative20:l,paletteSemanticRed:c,paletteSemanticGreen:y,paletteSemanticYellow:d,paletteSequence:m,fontFamily:g,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:Lt[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:Lt[65],tooltipItemNameFillColor:Lt[65],tooltipItemValueFillColor:Lt[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:Lt[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:C,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:Ct[100],pointActiveBorderColor:Lt[100],pointSelectedBorderColor:Lt[100]}},Ft=(St(),{100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"}),Ot={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},wt=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],kt=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],Tt=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],Et=function(t){void 0===t&&(t={});var e=t.mapStyle,o=void 0===e?"dark":e,n=t.subColor,i=void 0===n?"rgba(255,255,255,0.05)":n,r=t.paletteQualitative10,a=void 0===r?wt:r,s=t.paletteQualitative20,l=void 0===s?kt:s,p=t.paletteSemanticRed,c=void 0===p?"#F4664A":p,u=t.paletteSemanticGreen,y=void 0===u?"#30BF78":u,h=t.paletteSemanticYellow,d=void 0===h?"#FAAD14":h,f=t.paletteSequence,m=void 0===f?Tt:f,v=t.fontFamily,g=void 0===v?'"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,\n    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",\n    "Noto Color Emoji"':v,L=t.brandColor,C=void 0===L?a[0]:L;return{mapStyle:o,brandColor:C,subColor:i,paletteQualitative10:a,paletteQualitative20:l,paletteSemanticRed:c,paletteSemanticGreen:y,paletteSemanticYellow:d,paletteSequence:m,fontFamily:g,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:Ot[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:Ot[65],tooltipItemNameFillColor:Ot[65],tooltipItemValueFillColor:Ot[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:Ot[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:wt[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:Ft[100],pointActiveBorderColor:Ot[100],pointSelectedBorderColor:Ot[100]}};Et();function It(t){var e=t.styleSheet,o=void 0===e?{}:e,n=pt(t,["styleSheet"]),i=St(o);return Y({},gt(i),n)}function Bt(t){var e=t.styleSheet,o=void 0===e?{}:e,n=pt(t,["styleSheet"]),i=Et(o);return Y({},gt(i),n)}var zt,At,jt,Ht,_t=It({}),Pt=Bt({}),Mt={default:_t,light:_t,dark:Pt};function Zt(t){return void 0===t&&(t="default"),et(Mt,_(t),Mt["default"])}function Nt(t,e,o){void 0===o&&(o="light"),Mt[_(t)]="light"===o?It(e):Bt(e)}(function(t){t[t["solid"]=0]="solid",t[t["dash"]=1]="dash"})(zt||(zt={})),function(t){t["TextLayer"]="textLayer",t["DotLayer"]="dotLayer",t["IconLayer"]="iconLayer",t["DotDensity"]="dotDensityLayer",t["ColumnLayer"]="columnLayer",t["HeatmapLayer"]="heatmapLayer",t["GridLayer"]="gridLayer",t["HexbinLayer"]="hexbinLayer",t["LinesLayer"]="linesLayer",t["PathLayer"]="pathLayer",t["ArcLayer"]="arcLayer",t["AreaLayer"]="areaLayer",t["PrismLayer"]="prismLayer"}(At||(At={})),function(t){t["Map"]="map",t["Amap"]="amap",t["AmapV1"]="amapv1",t["AmapV2"]="amapv2",t["Mapbox"]="mapbox"}(jt||(jt={})),function(t){t["Dot"]="dot",t["DotDensity"]="dotDensity",t["Heatmap"]="heatmap",t["Grid"]="grid",t["Hexbin"]="hexbin",t["Path"]="path",t["Flow"]="flow",t["Area"]="area",t["Choropleth"]="choropleth"}(Ht||(Ht={}));var Gt=o(14071),Rt="*",Vt=function(){function t(){this._events={}}return t.prototype.on=function(t,e,o){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!o}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];var i=this._events[t]||[],r=this._events[Rt]||[],a=function(n){for(var i=n.length,r=0;r<i;r++)if(n[r]){var a=n[r],s=a.callback,l=a.once;l&&(n.splice(r,1),0===n.length&&delete e._events[t],i--,r--),s.apply(e,o)}};a(i),a(r)},t.prototype.off=function(t,e){if(t)if(e){for(var o=this._events[t]||[],n=o.length,i=0;i<n;i++)o[i].callback===e&&(o.splice(i,1),n--,i--);0===o.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}(),Kt=Vt;function Ut(t,e){if(t)for(var o in e)e.hasOwnProperty(o)&&(t.style[o]=e[o]);return t}var Wt,Qt,qt,Yt,Xt,$t={fontFamily:'\n  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",\n  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",\n  SimSun, "sans-serif"'},Jt="l7plot-legend l7plot-legend__category",te="l7plot-legend__title",ee="l7plot-legend__category-list",oe="l7plot-legend__list-item",ne="l7plot-legend__category-marker",ie="l7plot-legend__category-value",re='<div class="'.concat(Jt,'">\n  <div class="').concat(te,'"></div>\n  <ul class="').concat(ee,'"></ul>\n</div>'),ae='<li class="'.concat(oe,'" data-index={index}>\n  <span class="').concat(ne,'" style="background:{color}"></span>\n  <span class="').concat(ie,'">{value}</span>\n</li>'),se=(Wt={},Wt[Jt]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:$t.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},Wt[te]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},Wt[ee]={margin:"0px",listStyleType:"none",padding:"0px"},Wt[oe]={listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},Wt[ne]={width:"10px",height:"10px"},Wt[ie]={paddingLeft:"8px"},Wt);function le(){Qt=document.createElement("table"),qt=document.createElement("tr"),Yt=/^\s*<(\w+|!)[^>]*>/,Xt={tr:document.createElement("tbody"),tbody:Qt,thead:Qt,tfoot:Qt,td:qt,th:qt,"*":document.createElement("div")}}function pe(t){Qt||le();var e=Yt.test(t)&&RegExp.$1;e&&e in Xt||(e="*");var o=Xt[e];t="string"===typeof t?t.replace(/(^\s*)|(\s*$)/g,""):t,o.innerHTML=""+t;var n=o.childNodes[0];return n&&o.contains(n)&&o.removeChild(n),n}function ce(t,e){return!!t.className.match(new RegExp("(\\s|^)".concat(e,"(\\s|$)")))}function ue(t){for(var e=t.childNodes,o=e.length,n=o-1;n>=0;n--)t.removeChild(e[n])}var ye,he,de=function(){function t(t){this.destroyed=!1,this.options=Y({},this.getDefaultOptions(),t),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}return t.prototype.getDefaultOptions=function(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}},t.prototype.getContainer=function(){return this.container},t.prototype.getParentContainer=function(){var t,e=this.options.parent;if(!e)return t;if(k(e)){var o=document.getElementById(e);if(!o)throw new Error("No parent id ".concat(e));t=o}else t=e;return t},t.prototype.initContainer=function(){var t=this.createDom(this.options.containerTpl),e=this.getParentContainer();return e&&e.appendChild(t),t},t.prototype.initVisible=function(){this.options.visible?this.show():this.hide()},t.prototype.initCapture=function(){this.setCapture(this.options.capture)},t.prototype.update=function(t){this.options=Y({},this.options,t),this.updateInner(t),this.afterUpdate(t)},t.prototype.updateInner=function(t){t.domStyles&&this.applyStyles()},t.prototype.afterUpdate=function(t){t.capture&&this.setCapture(t.capture)},t.prototype.setCapture=function(t){var e=this.container,o=t?"auto":"none";e.style.pointerEvents=o},t.prototype.applyStyles=function(){var t=this.options.domStyles;if(t){var e=this.container;this.applyChildrenStyles(e,t);var o=this.options.className;if(o&&ce(e,o)){var n=t[o];Ut(e,n)}}},t.prototype.applyChildrenStyles=function(t,e){D(e,(function(e,o){var n=t.getElementsByClassName(o);D(n,(function(t){Ut(t,e)}))}))},t.prototype.applyStyle=function(t,e){var o=this.options.domStyles;o&&Ut(e,o[t])},t.prototype.createDom=function(t){return void 0===t&&(t="<div></div>"),pe(t)},t.prototype.removeDom=function(){var t=this.container;t&&t.parentNode&&t.parentNode.removeChild(t)},t.prototype.destroy=function(){this.removeEvent(),this.removeDom(),this.destroyed=!0},t}(),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return st(e,t),e.prototype.getDefaultOptions=function(){return Y({},t.prototype.getDefaultOptions.call(this),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:re,itemTpl:ae,domStyles:se,className:Jt})},e.prototype.initContainer=function(){var e=this.options.customContent;if(e){var o=this.getHtmlContentNode(e),n=this.getParentContainer();return n&&n.appendChild(o),o}return t.prototype.initContainer.call(this)},e.prototype.initDom=function(){this.cacheDoms()},e.prototype.initEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.cacheDoms=function(){var t=this.container,e=t.getElementsByClassName(te)[0],o=t.getElementsByClassName(ee)[0];this.titleDom=e,this.listDom=o},e.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},e.prototype.show=function(){var t=this.container;t&&!this.destroyed&&Ut(t,{visibility:"visible"})},e.prototype.hide=function(){var t=this.container;t&&!this.destroyed&&Ut(t,{visibility:"hidden"})},e.prototype.updateInner=function(e){this.options.customContent?this.renderCustomContent(this.options.customContent):(e.title&&this.resetTitle(),e.items&&this.renderItems()),t.prototype.updateInner.call(this,e)},e.prototype.renderCustomContent=function(t){var e=this.container.parentNode,o=this.getHtmlContentNode(t),n=this.container;e&&e.replaceChild(o,n),this.container=o,this.applyStyles()},e.prototype.getHtmlContentNode=function(t){var e,o=t(this.options.title||"",this.options.items);return e=k(o)?this.createDom(o):o,e},e.prototype.resetTitle=function(){var t=this.options.title;t?(this.showTitle(),this.setTitle(t)):this.hideTitle()},e.prototype.showTitle=function(){var t=this.titleDom;t&&Ut(t,{display:"block"})},e.prototype.hideTitle=function(){var t=this.titleDom;t&&Ut(t,{display:"none"})},e.prototype.setTitle=function(t){var e=this.titleDom;e&&(e.innerHTML=t)},e.prototype.renderItems=function(){var t=this;this.clearItemDoms();var e=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,o=this.options.itemTpl||ae,n=this.listDom;n&&(e.forEach((function(e){var i=""===e.value,r=i?"\u2014":Array.isArray(e.value)?e.value.join(" - "):e.value,a=lt(lt({},e),{value:r}),s=M(o,a),l=t.createDom(s);n.appendChild(l)})),this.applyChildrenStyles(n,this.options.domStyles))},e.prototype.clearItemDoms=function(){this.listDom&&ue(this.listDom)},e.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},e}(de),me="l7plot-legend l7plot-legend__continue",ve="l7plot-legend__title",ge="l7plot-legend__ribbon-container",Le="l7plot-legend__ribbon",Ce="l7plot-legend__gradient-bar",be="l7plot-legend__value-range",De='<div class="'.concat(me,'">\n  <div class="').concat(ve,'"></div>\n  <div class="').concat(ge,'"></div>\n</div>'),xe='<div class="'.concat(Le,'">\n  <span class="').concat(be,'">{min}</span>\n  <div class="').concat(Ce,'" style="background-image: {backgroundImage}"></div>\n  <span class="').concat(be,'">{max}</span>\n</div>'),Se=(ye={},ye[me]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:$t.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},ye[ve]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},ye[Le]={display:"flex",alignItems:"center"},ye[Ce]={width:"140px",height:"14px",margin:"0px 5px"},ye[be]={padding:"0px"},ye),Fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return st(e,t),e.prototype.getDefaultOptions=function(){return Y({},t.prototype.getDefaultOptions.call(this),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:De,ribbonTpl:xe,domStyles:Se,className:me})},e.prototype.initContainer=function(){var e=this.options.customContent;if(e){var o=this.getHtmlContentNode(e),n=this.getParentContainer();return n&&n.appendChild(o),o}return t.prototype.initContainer.call(this)},e.prototype.initDom=function(){this.cacheDoms()},e.prototype.initEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.cacheDoms=function(){var t=this.container,e=t.getElementsByClassName(ve)[0],o=t.getElementsByClassName(ge)[0];this.titleDom=e,this.ribbonContainerDom=o},e.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())},e.prototype.show=function(){var t=this.container;t&&!this.destroyed&&Ut(t,{visibility:"visible"})},e.prototype.hide=function(){var t=this.container;t&&!this.destroyed&&Ut(t,{visibility:"hidden"})},e.prototype.updateInner=function(e){this.options.customContent?this.renderCustomContent(this.options.customContent):(e.title&&this.resetTitle(),e.colors&&this.renderRibbon()),t.prototype.updateInner.call(this,e)},e.prototype.renderCustomContent=function(t){var e=this.container.parentNode,o=this.getHtmlContentNode(t),n=this.container;e&&e.replaceChild(o,n),this.container=o,this.applyStyles()},e.prototype.getHtmlContentNode=function(t){var e,o=t(this.options.title||"",this.options.min,this.options.max,this.options.colors);return e=k(o)?this.createDom(o):o,e},e.prototype.resetTitle=function(){var t=this.options.title;t?(this.showTitle(),this.setTitle(t)):this.hideTitle()},e.prototype.showTitle=function(){var t=this.titleDom;t&&Ut(t,{display:"block"})},e.prototype.hideTitle=function(){var t=this.titleDom;t&&Ut(t,{display:"none"})},e.prototype.setTitle=function(t){var e=this.titleDom;e&&(e.innerHTML=t)},e.prototype.renderRibbon=function(){this.clearRibbonContainerDoms();var t=this.options,e=t.min,o=t.max,n=t.colors,i=t.ribbonTpl,r=void 0===i?xe:i,a=this.ribbonContainerDom;if(a){var s="linear-gradient(to right, ".concat(n.join(", "),")"),l={min:e,max:o,backgroundImage:s},p=M(r,l),c=this.createDom(p);a.appendChild(c),this.applyChildrenStyles(a,this.options.domStyles)}},e.prototype.clearRibbonContainerDoms=function(){this.ribbonContainerDom&&ue(this.ribbonContainerDom)},e.prototype.clear=function(){this.setTitle(""),this.clearRibbonContainerDoms()},e}(de),Oe=function(t){function e(e){var o=t.call(this,e)||this;return o.legendComponents=[],o.options=e,o.legendComponents=o.initLegendComponents(e.items),o}return st(e,t),e.prototype.initLegendComponents=function(t){for(var e=[],o=0;o<t.length;o++){var n=t[o];if("category"===n.type){var i=new fe({title:n.options.title,items:n.options.items,className:n.options.className,customContent:n.options.customContent,domStyles:n.options.domStyles});e.push(i)}else if("continue"===n.type){i=new Fe({title:n.options.title,min:n.options.min,max:n.options.max,colors:n.options.colors,className:n.options.className,customContent:n.options.customContent,domStyles:n.options.domStyles});e.push(i)}}return e},e.prototype.getDefaultOptions=function(){return{position:"bottomleft"}},e.prototype.onAdd=function(){var t=window.document.createElement("div");return t.className="l7plot-legend-container",this.legendComponents.forEach((function(e){var o=e.getContainer();t.appendChild(o)})),t},e.prototype.onRemove=function(){this.legendComponents.forEach((function(t){t.destroy()}))},e}(Gt.Control),we="l7plot-tooltip",ke="l7plot-tooltip__title",Te="l7plot-tooltip__list",Ee="l7plot-tooltip__list-item",Ie="l7plot-tooltip__name",Be="l7plot-tooltip__value",ze='<div class="'.concat(we,'">\n  <div class="').concat(ke,'"></div>\n  <ul class="').concat(Te,'"></ul>\n</div>'),Ae='<li class="'.concat(Ee,'" data-index={index}>\n  <span class="').concat(Ie,'">{name}</span>\n  <span class="').concat(Be,'">{value}</span>\n</li>'),je=(he={},he[we]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:$t.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},he[ke]={marginBottom:"4px"},he[Te]={margin:"0px",listStyleType:"none",padding:"0px"},he[Ee]={listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},he[Ie]={},he[Be]={marginLeft:"30px"},he),He=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return st(e,t),e.prototype.getDefaultOptions=function(){return Y({},t.prototype.getDefaultOptions.call(this),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:ze,itemTpl:Ae,domStyles:je,className:we})},e.prototype.initContainer=function(){var e=this.options.customContent;if(e){var o=this.getHtmlContentNode(e),n=this.getParentContainer();return n&&n.appendChild(o),o}return t.prototype.initContainer.call(this)},e.prototype.initDom=function(){this.cacheDoms()},e.prototype.initEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.cacheDoms=function(){var t=this.container,e=t.getElementsByClassName(ke)[0],o=t.getElementsByClassName(Te)[0];this.titleDom=e,this.listDom=o},e.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},e.prototype.show=function(){var t=this.container;t&&!this.destroyed&&Ut(t,{visibility:"visible"})},e.prototype.hide=function(){var t=this.container;t&&!this.destroyed&&Ut(t,{visibility:"hidden"})},e.prototype.updateInner=function(e){this.options.customContent?this.renderCustomContent(this.options.customContent):(e.title&&this.resetTitle(),e.items&&this.renderItems()),t.prototype.updateInner.call(this,e)},e.prototype.renderCustomContent=function(t){var e=this.container.parentNode,o=this.getHtmlContentNode(t),n=this.container;e&&e.replaceChild(o,n),this.container=o,this.applyStyles()},e.prototype.getHtmlContentNode=function(t){var e,o=t(this.options.title||"",this.options.items);return e=k(o)?this.createDom(o):o,e},e.prototype.resetTitle=function(){var t=this.options.title,e=this.options.showTitle;e&&t?(this.showTitle(),this.setTitle(t)):this.hideTitle()},e.prototype.showTitle=function(){var t=this.titleDom;t&&Ut(t,{display:"block"})},e.prototype.hideTitle=function(){var t=this.titleDom;t&&Ut(t,{display:"none"})},e.prototype.setTitle=function(t){var e=this.titleDom;e&&(e.innerHTML=t)},e.prototype.renderItems=function(){var t=this;this.clearItemDoms();var e=this.options.items,o=this.options.itemTpl||Ae,n=this.listDom;n&&(e.forEach((function(e){var i=lt({},e),r=M(o,i),a=t.createDom(r);n.appendChild(a)})),this.applyChildrenStyles(n,this.options.domStyles))},e.prototype.clearItemDoms=function(){this.listDom&&ue(this.listDom)},e.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},e}(de),_e=o(56136),Pe=5,Me=(new Object).toString,Ze=function(t,e){return Me.call(t)==="[object "+e+"]"},Ne=function(t){return Ze(t,"Array")},Ge=function(t){return"object"===typeof t&&null!==t},Re=function(t){if(!Ge(t)||!Ze(t,"Object"))return!1;var e=t;while(null!==Object.getPrototypeOf(e))e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},Ve=function(t,e,o,n){for(var i in o=o||0,n=n||Pe,e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=e[i];r?Re(r)?(Re(t[i])||(t[i]={}),o<n?Ve(t[i],r,o+1,n):t[i]=e[i]):Ne(r)?(t[i]=[],t[i]=t[i].concat(r)):t[i]=r:t[i]=r}},Ke=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];for(var n=0;n<e.length;n+=1)Ve(t,e[n]);return t},Ue=["mousemove","click"],We=function(t){function e(e,o,n){var i=t.call(this)||this;i.currentVisible=!1,i.interactionTriggerHander=function(t){var e=t.feature,o=t.featureId,n=i.options,r=n.title,a=n.customTitle,s=n.items,l=n.customItems,p="Feature"===e.type&&e.geometry&&e.properties,c=p?e.properties:e,u=[];if(l){var y=l(e);if(!Array.isArray(y))throw new Error("customItems return array");u=y}else s&&s.forEach((function(t){if(k(t)){var e=t.split(".").pop()||t,n=(0,_e.Z)(c,t);void 0!==n&&u.push({name:e,value:n})}else{var i=t.field,r=t.alias,a=t.customValue,s=r||i.split(".").pop()||i;n=(0,_e.Z)(c,i);void 0!==n&&u.push({name:s,value:a?a(n,c,o):n})}}));var h={title:a?a(c):r,items:u};i.updateTooltip(t,h)},i.interactionUntriggerHander=function(){i.hideTooltip()},i.scene=e,i.interactionLayers=o,i.options=Ke({},i.getDefaultOptions(),n);var r=i.options,a=r.offsets,s=r.title,l=r.showTitle,p=r.customContent,c=r.domStyles,u=r.anchor,y=r.className;return i.marker=new Gt.Marker({offsets:a,anchor:u,draggable:!1}),i.tooltipComponent=new He({title:s,showTitle:l,items:[],customContent:p,domStyles:c,className:y}),i.setComponent(),i.initInteractionEvent(),i}return st(e,t),e.prototype.getDefaultOptions=function(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:Gt.anchorType["TOP-LEFT"]}},e.prototype.update=function(t){this.marker.remove(),this.currentVisible=!1,this.options=Ke({},this.options,t);var e=this.options,o=e.offsets,n=e.showTitle,i=e.customContent,r=e.domStyles,a=e.anchor,s=e.className;this.marker=new Gt.Marker({offsets:o,anchor:a,draggable:!1}),this.tooltipComponent.update({showTitle:n,customContent:i,domStyles:r,className:s}),this.setComponent()},e.prototype.initInteractionEvent=function(){var t=this,e=this.options.trigger||"mousemove";if(!Ue.includes(e))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach((function(o){var n=o.layer;n.on(e,t.interactionTriggerHander),n.on("un".concat(e),t.interactionUntriggerHander)}))},e.prototype.unBindInteractionEvent=function(){var t=this,e=this.options.trigger||"mousemove";this.interactionLayers.forEach((function(o){var n=o.layer;n.off(e,t.interactionTriggerHander),n.off("un".concat(e),t.interactionUntriggerHander)}))},e.prototype.updateTooltip=function(t,e){var o=t.lngLat,n=t.x,i=t.y;if(this.options.showComponent&&(this.updateComponent(e),this.setPostion(o)),this.currentVisible){var r={type:"tooltip:change",data:e,lngLat:o,x:n,y:i};this.emit("tooltip:change",r)}else{this.showTooltip();var a={type:"tooltip:show",data:e,lngLat:o,x:n,y:i};this.emit("tooltip:show",a)}},e.prototype.showTooltip=function(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)},e.prototype.hideTooltip=function(){if(this.currentVisible){this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;var t={type:"tooltip:hide"};this.emit("tooltip:hide",t)}},e.prototype.updateComponent=function(t){tt(this.lastComponentOptions,t)||(this.tooltipComponent.update(t),this.lastComponentOptions=t)},e.prototype.setComponent=function(){var t=this.tooltipComponent.getContainer(),e=window.document.createElement("div");e.style.cursor="auto",e.style.userSelect="text",e.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach((function(t){e.addEventListener(t,(function(t){return t.stopPropagation()}))})),e.appendChild(t),this.marker.setElement(e)},e.prototype.setPostion=function(t){this.marker.setLnglat(t)},e.prototype.destroy=function(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()},e}(Kt),Qe=function(t){function e(e,o){void 0===e&&(e=[]),void 0===o&&(o={});var n=t.call(this)||this;return n.name=o.name?o.name:rt("layerGroup"),n.layers=e,n}return st(e,t),e.prototype.addTo=function(t){var e=this;this.scene=t;var o=0,n=this.layers.length;this.layers.forEach((function(i){i.once("inited",(function(t){o++,e.emit("inited",t),o===n&&e.emit("inited-all")})),i.addTo(t)}))},e.prototype.hasLayer=function(t){return this.layers.some((function(e){return e===t}))},e.prototype.addLayer=function(t){var e=this;this.layers.push(t),this.scene&&(t.once("inited",(function(t){return e.emit("inited",t)})),t.addTo(this.scene))},e.prototype.removeLayer=function(t){var e=this.layers.findIndex((function(e){return e===t}));return-1!==e&&(this.layers.splice(e,1),this.scene&&t.remove(this.scene),!0)},e.prototype.getLayers=function(){return this.layers},e.prototype.getInteractionLayers=function(){return this.layers.filter((function(t){var e=t.interaction;return e}))},e.prototype.getLayer=function(t){return this.layers.find((function(e){var o=e.layer;return o.id===t}))},e.prototype.getLayerByName=function(t){return this.layers.find((function(e){return e.name===t}))},e.prototype.removeAllLayer=function(){var t=this;this.layers.forEach((function(e){t.scene&&e.remove(t.scene)})),this.layers=[]},e.prototype.isEmpty=function(){return 0===this.layers.length},e}(Kt),qe=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}],Ye=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"],Xe=["inited","add","remove","dataUpdate","click","unclick","dblclick","undblclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick"],$e={map:{type:jt.Amap},logo:!0},Je=function(t){function e(e){var o=t.call(this)||this;return o.inited=!1,o.sceneLoaded=!1,o.layersLoaded=!1,o.loaded=!1,o.layerGroup=new Qe,o.options=Ke({},o.getDefaultOptions(),e),o.lastOptions=o.options,o}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createContainer=function(t){var e=this.options,o=e.width,n=e.height,i="string"===typeof t?document.getElementById(t):t;return i.style.position||(i.style.position="relative"),o&&(i.style.width||(i.style.width="".concat(o,"px"))),n&&(i.style.height||(i.style.height="".concat(n,"px"))),i},e.prototype.createTheme=function(){var t=C(this.options.theme)?Ke({},Zt("default"),It(this.options.theme)):Zt(this.options.theme);return t},e.prototype.createMap=function(){var t=this.options.map?this.options.map:$e.map,e=t.type,o=pt(t,["type"]),n=Object.assign({style:this.theme["mapStyle"]},o);return e===jt.Amap?new Gt.GaodeMap(n):e===jt.AmapV1?new Gt.GaodeMapV1(n):e===jt.AmapV2?new Gt.GaodeMapV2(n):e===jt.Mapbox?new Gt.Mapbox(n):new Gt.Map(n)},e.prototype.createScene=function(){var t=this.options,e=t.logo,o=t.antialias,n=t.preserveDrawingBuffer,i=N(e)?{logoVisible:e}:{logoVisible:null===e||void 0===e?void 0:e.visible,logoPosition:null===e||void 0===e?void 0:e.position},r=Object.assign({antialias:o,preserveDrawingBuffer:n},i),a=this.createMap(),s=new Gt.Scene(lt({id:this.container,map:a},r));return s},e.prototype.registerResources=function(){var t=this;i.size&&i.forEach((function(e,o){!t.scene.hasImage(o)&&t.scene.addImage(o,e)})),l.size&&l.forEach((function(e,o){t.scene.addFontFace(o,e)})),u.size&&u.forEach((function(e,o){t.scene.addIconFont(o,e)}))},e.prototype.update=function(t){this.updateOption(t),t.map&&!tt(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),this.render(),this.emit("update")},e.prototype.updateOption=function(t){this.lastOptions=this.options,this.options=Ke({},this.options,t)},e.prototype.updateMap=function(t){var e;if(this.scene){var o=t.style,n=t.center,i=t.zoom,r=t.rotation,a=t.pitch;R(a)||this.scene.setPitch(a),R(r)||this.scene.setRotation(r),o&&o!==(null===(e=this.lastOptions.map)||void 0===e?void 0:e.style)&&this.scene.setMapStyle(o),i&&n&&this.scene.setZoomAndCenter(i,n)}},e.prototype.changeSize=function(t,e){this.options.width===t&&this.options.height===e||(this.container.style.width="".concat(t,"px"),this.container.style.height="".concat(e,"px"),this.options=Object.assign(this.options,{width:t,height:e}))},e.prototype.on=function(t,e,o){return this.proxyEventHander("on",t,e,o),this},e.prototype.once=function(t,e){return this.proxyEventHander("once",t,e),this},e.prototype.off=function(t,e){return this.proxyEventHander("off",t,e),this},e.prototype.proxyEventHander=function(e,o,n,i){var r=qe.find((function(t){return t.adaptation===o}));if(r)this.scene[e](r.original,n);else if(-1!==Ye.indexOf(o))this.scene[e](o,n);else if(o.includes("Layer:")){var a=yt(o.split(":"),2),s=a[0],l=a[1],p=this[s]&&this[s][e];if(!p||-1===Xe.indexOf(l))throw new Error('No event name "'.concat(o,'"'));this[s][e](l,n)}else t.prototype[e].call(this,o,n,i)},e.prototype.getScene=function(){return this.scene},e.prototype.getMap=function(){var t,e,o,n;return(null===(t=this.options.map)||void 0===t?void 0:t.type)===jt.Amap||(null===(e=this.options.map)||void 0===e?void 0:e.type)===jt.AmapV2||(null===(o=this.options.map)||void 0===o?void 0:o.type)===jt.Mapbox||(null===(n=this.options.map)||void 0===n||n.type,jt.Map),this.scene.map},e.prototype.addLayer=function(t){this.layerGroup.addLayer(t)},e.prototype.getLayes=function(){return console.warn("Replace to use getLayers()"),this.getLayers()},e.prototype.getLayers=function(){return this.layerGroup.getLayers()},e.prototype.getLayerByName=function(t){return this.layerGroup.getLayerByName(t)},e.prototype.removeLayer=function(t){return this.layerGroup.removeLayer(t)},e.prototype.removeAllLayer=function(){this.layerGroup.removeAllLayer()},e.prototype.zoomIn=function(){this.scene.zoomIn()},e.prototype.zoomOut=function(){this.scene.zoomOut()},e.prototype.setPitch=function(t){this.scene.setPitch(t)},e.prototype.fitBounds=function(t){this.scene.fitBounds(t)},e.prototype.setMapStatus=function(t){this.scene.setMapStatus(t)},e.prototype.setBgColor=function(t){this.scene.setBgColor(t)},e.prototype.initComponents=function(){this.initControls(),this.initTooltip()},e.prototype.updateComponents=function(){this.updateControls(),this.initTooltip()},e.prototype.initControls=function(){var t=this.options,e=t.zoom,o=t.scale,n=t.layerMenu,i=t.legend;o&&this.addScaleControl(o),e&&this.addZoomControl(e),n&&this.addLayerMenuControl(n),i&&(this.addLegendControl(i),this.emit("add-legend"))},e.prototype.updateControls=function(){var t=this.options,e=t.zoom,o=t.scale,n=t.layerMenu,i=t.legend;tt(this.lastOptions.zoom,e)||(e?this.updateZoomControl(e):this.removeZoomControl()),tt(this.lastOptions.scale,o)||(o?this.updateScaleControl(o):this.removeScaleControl()),tt(this.lastOptions.layerMenu,n)||(n?this.updateLayerMenuControl(n):this.removeLayerMenuControl()),tt(this.lastOptions.legend,i)||(i?this.updateLegendControl(i):this.removeLegendControl())},e.prototype.addZoomControl=function(t){this.zoomControl||(this.zoomControl=new Gt.Zoom(t),this.scene.addControl(this.zoomControl))},e.prototype.updateZoomControl=function(t){this.zoomControl?(this.removeZoomControl(),this.addZoomControl(t)):this.addZoomControl(t)},e.prototype.removeZoomControl=function(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)},e.prototype.addScaleControl=function(t){this.scaleControl||(this.scaleControl=new Gt.Scale(t),this.scene.addControl(this.scaleControl))},e.prototype.updateScaleControl=function(t){this.scaleControl?(this.removeScaleControl(),this.addScaleControl(t)):this.addScaleControl(t)},e.prototype.removeScaleControl=function(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)},e.prototype.addLayerMenuControl=function(t){var e={};this.layerGroup.getLayers().forEach((function(t){var o=t.name,n=t.layer;e[o]=n}))},e.prototype.updateLayerMenuControl=function(t){this.removeLayerMenuControl(),this.addLayerMenuControl(t)},e.prototype.removeLayerMenuControl=function(){},e.prototype.getLegendOptions=function(){return{}},e.prototype.addLegendControl=function(t){if(!this.legendControl){var e=this.theme["components"].legend,o=Ke({},this.getLegendOptions(),t),n=o.type,i=o.position,r=pt(o,["type","position"]),a=[];if("category"===n){var s=Ke({},{domStyles:e.category.domStyles},r);a.push({type:n,options:s})}else if("continue"===n){var l=Ke({},{domStyles:e.continue.domStyles},r);a.push({type:n,options:l})}a.length&&(this.legendControl=new Oe({position:i,items:a}),this.scene.addControl(this.legendControl))}},e.prototype.updateLegendControl=function(t){this.legendControl?(this.removeLegendControl(),this.addLegendControl(t)):this.addLegendControl(t)},e.prototype.removeLegendControl=function(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)},e.prototype.initTooltip=function(){var t=this;this.tooltip&&this.tooltip.destroy();var e=this.options.tooltip;if(e){var o=Ke({},{domStyles:this.theme["components"].tooltip.domStyles},e),n=this.layerGroup.getInteractionLayers();this.tooltip=new We(this.scene,n,o),this.tooltip.on("*",(function(e){return t.emit(e.type,e)}))}},e.prototype.exportPng=function(t){return this.scene.exportPng(t)},e.prototype.destroy=function(){var e;t.prototype.off.call(this,"*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),null===(e=this.tooltip)||void 0===e||e.destroy(),this.scene.destroy()},e.DefaultOptions=$e,e}(Kt),to=function(){function t(){}return t.aggregation=function(t,e){var o=e.type,n=void 0===o?"grid":o,i=e.radius,r=e.method,a=e.field,s={type:n,size:i,method:r,field:a};t.transforms?(t.transforms=t.transforms.filter((function(t){return t.type!==s.type})),t.transforms.push(s)):t.transforms=[s]},t}(),eo=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"],oo=function(t){function e(e){var o=t.call(this)||this;return o.options=Ke({},o.getDefaultOptions(),e),o.lastOptions=o.options,o}return st(e,t),e.prototype.getDefaultOptions=function(){return{}},e.prototype.pickLayerConfig=function(t){var e=nt(t,eo);return e},e.prototype.addTo=function(t){t.addLayer(this.layer)},e.prototype.remove=function(t){t.removeLayer(this.layer)},e.prototype.update=function(t){this.updateOption(t),this.updateConfig(t)},e.prototype.updateOption=function(t){this.lastOptions=this.options,this.options=Ke({},this.options,t)},e.prototype.updateConfig=function(t){R(t.zIndex)||tt(this.lastOptions.zIndex,this.options.zIndex)||this.setIndex(t.zIndex),R(t.blend)||tt(this.lastOptions.blend,this.options.blend)||this.setBlend(t.blend),R(t.minZoom)||tt(this.lastOptions.minZoom,this.options.minZoom)||this.setMinZoom(t.minZoom),R(t.maxZoom)||tt(this.lastOptions.maxZoom,this.options.maxZoom)||this.setMinZoom(t.maxZoom),R(t.visible)||tt(this.lastOptions.visible,this.options.visible)||(t.visible?this.show():this.hide())},e.prototype.render=function(){this.layer.renderLayers()},e.prototype.setSource=function(t){if(t instanceof Gt.Source)this.layer.setSource(t);else{var e=t.data,o=t.aggregation,n=pt(t,["data","aggregation"]);o&&to.aggregation(n,o);var i=this.layer.getSource();i?this.layer.setData(e,n):this.layer.source(e,n)}},e.prototype.changeData=function(t){this.setSource(t)},e.prototype.setIndex=function(t){this.layer.setIndex(t)},e.prototype.setBlend=function(t){this.layer.setBlend(t)},e.prototype.setMinZoom=function(t){this.layer.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.layer.setMaxZoom(t)},e.prototype.show=function(){this.layer.inited&&this.layer.show()},e.prototype.hide=function(){this.layer.inited&&this.layer.hide()},e.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},e.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():this.options.visible},e.prototype.fitBounds=function(t){this.layer.fitBounds(t)},e.prototype.on=function(e,o){return-1!==Xe.indexOf(e)?this.layer.on(e,o):t.prototype.on.call(this,e,o),this},e.prototype.once=function(e,o){return-1!==Xe.indexOf(e)?this.layer.once(e,o):t.prototype.once.call(this,e,o),this},e.prototype.off=function(e,o){return-1!==Xe.indexOf(e)?this.layer.off(e,o):t.prototype.off.call(this,e,o),this},e.LayerType=At,e.LayerConfigkeys=eo,e}(Kt);function no(t,e){return function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var i={};return t.forEach((function(t,e){i[t]=o[e]})),delete i["undefined"],e(i)}}var io=function(){function t(){}return t.shape=function(e,o){if(k(o))e.shape(o);else if(g(o)){var n=[];e.shape(n.join("*"),no(n,o))}else if(C(o)){var i=o.field?o.field:"";if(g(o.value)){n=L(i)?i:i.split("*");e.shape(i,no(n,o.value))}else e.shape(i,o.value);k(i)&&o.scale&&t.scale(e,i,o.scale)}},t.size=function(e,o){if(E(o))e.size(o);else if(L(o))e.size(o);else if(g(o)){var n=[];e.size(n.join("*"),no(n,o))}else if(C(o)){var i=o.field?o.field:"";if(g(o.value)){n=L(i)?i:i.split("*");e.size(i,no(n,o.value))}else e.size(i,o.value);k(i)&&o.scale&&t.scale(e,i,o.scale)}},t.color=function(e,o){if(k(o))e.color(o);else if(g(o)){var n=[];e.color(n.join("*"),no(n,o))}else if(C(o)){var i=o.field?o.field:"";if(g(o.value)){n=L(i)?i:i.split("*");e.color(i,no(n,o.value))}else e.color(i,o.value);k(i)&&o.scale&&t.scale(e,i,o.scale)}},t.style=function(t,e){e&&t.style(e)},t.state=function(t,e){var o=e.active,n=e.select;o&&t.active(o),n&&t.select(n)},t.rotate=function(t,e){k(e)||g(e)||C(e)},t.texture=function(t,e){k(e)&&t.texture(e)},t.animate=function(t,e){(N(e)||C(e))&&t.animate(e)},t.scale=function(t,e,o){t.scale(e,o)},t.filter=function(t,e){var o=e.field?e.field:"",n=L(o)?o:o.split("*");t.filter(n.join("*"),no(n,e.value))},t}();function ro(t,e){var o=e.field,n=e.content,i=e.style,r=void 0===i?{}:i,a=e.state,s=r.fontSize,l=r.fill,p=o||(n||""),c={field:p,value:"text"};io.shape(t,c),s&&io.size(t,s),l&&io.color(t,l),r&&io.style(t,r),a&&io.state(t,a)}var ao={style:{fontSize:12}},so=[],lo=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.TextLayer,o.interaction=!1;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.PointLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return ao},e.prototype.mappingLayer=function(t,e){ro(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.DefaultOptions=ao,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(so),e}(oo),po={autoFit:!1},co=function(t){function e(e,o){var n=this;if("string"===typeof e||e instanceof Element){if(void 0===o)throw new Error("options is undefined");n=t.call(this,o)||this,n.container=n.createContainer(e),n.theme=n.createTheme(),n.scene=n.createScene(),n.registerResources(),n.initSource()}else n=t.call(this,e)||this;return n}return st(e,t),e.prototype.initSource=function(){this.source=this.createSource(),this.render(),this.inited=!0},e.prototype.initLayersEvent=function(){},e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createSource=function(){var t=this.options.source,e=t.data,o=t.aggregation,n=pt(t,["data","aggregation"]);o&&to.aggregation(n,o);var i=new Gt.Source(e,n);return i},e.prototype.createLabelLayer=function(t,e,o){var n=o||{},i=n.visible,r=n.minZoom,a=n.maxZoom,s=n.zIndex,l=void 0===s?0:s,p=new lo(lt({name:"labelLayer",visible:i,minZoom:r,maxZoom:a,zIndex:l+.1,source:t},e));return p},e.prototype.updateLabelLayer=function(t,e,o,n){e?n?n.update(lt({},e)):(n=this.createLabelLayer(t,e,o),this.layerGroup.addLayer(n)):!1===e&&n&&this.layerGroup.removeLayer(n)},e.prototype.render=function(){var t=this,e=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),e.addTo(this.scene),this.layerGroup=e):(this.layerGroup=e,this.scene["sceneService"].loaded?this.onSceneLoaded():this.scene.once("loaded",(function(){t.onSceneLoaded()}))),this.initLayersEvent()},e.prototype.onSceneLoaded=function(){var t=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",(function(){t.onLayersLoaded()})),this.layerGroup.addTo(this.scene)},e.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")},e.prototype.attachToScene=function(t,e){this.scene=t,this.theme=e||Zt("default"),this.registerResources(),this.initSource()},e.prototype.unattachFromScene=function(){var t;this.removeAllLayer(),null===(t=this.tooltip)||void 0===t||t.destroy()},e.prototype.addToScene=function(t){this.attachToScene(t)},e.prototype.removeFromScene=function(){var t;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),null===(t=this.tooltip)||void 0===t||t.destroy()},e.prototype.update=function(t){if(this.updateOption(t),t.map&&!tt(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),this.scene.setEnableRender(!1),t.source&&!tt(this.lastOptions.source,this.options.source)){var e=t.source,o=e.data,n=pt(e,["data"]);this.changeData(o,n)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")},e.prototype.changeData=function(t,e){var o=this;this.options.source=Ke({},this.options.source,lt({data:t},e));var n=this.options.source,i=n.aggregation,r=pt(n,["aggregation"]);i&&to.aggregation(r,i),this.source.setData(this.options.source.data,r);var a=this.options.legend;a&&setTimeout((function(){o.updateLegendControl(a)})),this.emit("change-data")},e.DefaultOptions=po,e.PlotType=Ht,e}(Je),uo=Ke({},co.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}});function yo(t,e){var o=e.shape,n=e.color,i=e.size,r=e.style,a=e.state,s=e.animate;o&&io.shape(t,o),i&&io.size(t,i),n&&io.color(t,n),r&&io.style(t,r),a&&io.state(t,a),s&&io.animate(t,s)}var ho=o(37348),fo=o(708),mo=1/0,vo=17976931348623157e292;function go(t){if(!t)return 0===t?t:0;if(t=(0,fo.Z)(t),t===mo||t===-mo){var e=t<0?-1:1;return e*vo}return t===t?t:0}var Lo=go;function Co(t){var e=Lo(t),o=e%1;return e===e?o?e-o:e:0}var bo=Co,Do=o(23928),xo=ho.Z.isFinite,So=Math.min;function Fo(t){var e=Math[t];return function(t,o){if(t=(0,fo.Z)(t),o=null==o?0:So(bo(o),292),o&&xo(t)){var n=((0,Do.Z)(t)+"e").split("e"),i=e(n[0]+"e"+(+n[1]+o));return n=((0,Do.Z)(i)+"e").split("e"),+(n[0]+"e"+(+n[1]-o))}return e(t)}}var Oo=Fo,wo=Oo("round"),ko=wo,To=function(t){return!Array.isArray(t[0].value)},Eo=function(t){if(To(t))return t;var e=t.map((function(t){return lt(lt({},t),{value:[ko(t.value[0],2),ko(t.value[1],2)]})}));return e},Io={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"circle",size:12,color:"#5FD3A6"},Bo=["shape","color","size","style","state","animate"],zo=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.DotLayer,o.interaction=!0;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.PointLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return Io},e.prototype.mappingLayer=function(t,e){yo(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&0!==t.length){var e=Eo(t);return e}return[]},e.DefaultOptions=Io,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(Bo),e}(oo),Ao=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Dot,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.dotLayer=new zo(lt({source:t},nt(this.options,zo.LayerOptionsKeys)));var e=new Qe([this.dotLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label,this.options),e.addLayer(this.labelLayer)),e},e.prototype.updateLayers=function(t){var e=nt(t,zo.LayerOptionsKeys);this.dotLayer.update(e),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.prototype.getLegendOptions=function(){var t=this.dotLayer.getColorLegendItems();return 0!==t.length?{type:"category",items:t}:{}},e.DefaultOptions=uo,e}(co),jo=Ke({},co.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}}),Ho=["color","size","style","state","animate"],_o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=zo.LayerType.DotDensity,e.interaction=!1,e}return st(e,t),e.prototype.getDefaultOptions=function(){return Ke({},zo.DefaultOptions,{shape:"dot",size:1})},e.LayerOptionsKeys=zo.LayerConfigkeys.concat(Ho),e}(zo),Po=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.DotDensity,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.dotDensityLayer=new _o(lt({source:t},nt(this.options,_o.LayerOptionsKeys)));var e=new Qe([this.dotDensityLayer]);return e},e.prototype.updateLayers=function(t){var e=nt(t,_o.LayerOptionsKeys);this.dotDensityLayer.update(e)},e.DefaultOptions=jo,e}(co),Mo=Ke({},co.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"}}});function Zo(t){var e=t.colorsRamp,o={colors:[],positions:[]};return e.forEach((function(t){var e=t.color,n=t.position;o.colors.push(e),o.positions.push(n)})),o}function No(t,e){var o=e.shape,n=e.size,i=e.style,r=e.state;o&&io.shape(t,o),n&&io.size(t,n),i&&("colorsRamp"in i&&(i.rampColors=Zo(i)),io.style(t,i)),r&&io.state(t,r)}var Go={source:{data:[],parser:{type:"json",x:"x",y:"y"}},shape:"heatmap",size:{value:[0,1]},style:{intensity:3,radius:20,opacity:1,colorsRamp:[{color:"rgba(33,102,172,0.0)",position:0},{color:"rgb(103,169,207)",position:.2},{color:"rgb(209,229,240)",position:.4},{color:"rgb(253,219,199)",position:.6},{color:"rgb(239,138,98)",position:.8},{color:"rgb(178,24,43,1.0)",position:1}]}},Ro=["shape","color","size","style","state"],Vo=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.HeatmapLayer,o.interaction=!1;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.HeatmapLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return Go},e.prototype.mappingLayer=function(t,e){No(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.DefaultOptions=Go,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(Ro),e}(oo),Ko=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Heatmap,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.heatmapLayer=new Vo(lt({source:t},nt(this.options,Vo.LayerOptionsKeys)));var e=new Qe([this.heatmapLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),e.addLayer(this.labelLayer)),e},e.prototype.updateLayers=function(t){var e=nt(t,Vo.LayerOptionsKeys);this.heatmapLayer.update(e),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.prototype.getLegendOptions=function(){var t,e=this.heatmapLayer.layer.getLegendItems("size");if(Array.isArray(e)&&0!==e.length){var o=e[0].value,n=e[e.length-1].value,i=null===(t=this.heatmapLayer.options.style)||void 0===t?void 0:t.colorsRamp.map((function(t){var e=t.color;return e}));return{type:"continue",min:o,max:n,colors:i}}return{}},e.DefaultOptions=Mo,e}(co),Uo=Ke({},co.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"grid",radius:15e3,method:"sum"}}});function Wo(t,e){var o=e.shape,n=e.color,i=e.size,r=e.style,a=e.state;o&&io.shape(t,o),i&&io.size(t,i),n&&io.color(t,n),r&&io.style(t,r),a&&io.state(t,a)}var Qo={source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"grid",field:"",radius:15e3,method:"sum"}},shape:"square",color:"#5FD3A6",style:{coverage:.9,angle:0,opacity:1}},qo=["shape","color","size","style","state"],Yo=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.GridLayer,o.interaction=!1;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.HeatmapLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return Qo},e.prototype.mappingLayer=function(t,e){Wo(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.DefaultOptions=Qo,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(qo),e}(oo),Xo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Grid,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.gridLayer=new Yo(lt({source:t},nt(this.options,Yo.LayerOptionsKeys)));var e=new Qe([this.gridLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),e.addLayer(this.labelLayer)),e},e.prototype.updateLayers=function(t){var e=nt(t,Yo.LayerOptionsKeys);this.gridLayer.update(e),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.DefaultOptions=Uo,e}(co),$o=Ke({},co.DefaultOptions,{source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"hexagon",radius:15e3,method:"sum"}}});function Jo(t,e){var o=e.shape,n=e.color,i=e.size,r=e.style,a=e.state;o&&io.shape(t,o),i&&io.size(t,i),n&&io.color(t,n),r&&io.style(t,r),a&&io.state(t,a)}var tn={source:{data:[],parser:{type:"json",x:"x",y:"y"},aggregation:{type:"hexagon",field:"",radius:15e3,method:"sum"}},shape:"hexagon",color:"#5FD3A6",style:{coverage:.9,angle:0,opacity:1}},en=["shape","color","size","style","state"],on=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.HexbinLayer,o.interaction=!1;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.HeatmapLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return tn},e.prototype.mappingLayer=function(t,e){Jo(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.DefaultOptions=tn,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(en),e}(oo),nn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Hexbin,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.hexbinLayer=new on(lt({source:t},nt(this.options,on.LayerOptionsKeys)));var e=new Qe([this.hexbinLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(this.source,this.options.label,this.options),e.addLayer(this.labelLayer)),e},e.prototype.updateLayers=function(t){var e=nt(t,on.LayerOptionsKeys);this.hexbinLayer.update(e),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.DefaultOptions=$o,e}(co),rn=Ke({},co.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}});function an(t,e){var o=e.shape,n=e.color,i=e.size,r=e.style,a=e.state,s=e.animate,l=e.texture;o&&io.shape(t,o),i&&io.size(t,i),n&&io.color(t,n),r&&io.style(t,r),a&&io.state(t,a),s&&io.animate(t,s),l&&io.texture(t,l)}var sn={},ln=["shape","color","size","style","state","animate"],pn=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.LinesLayer,o.interaction=!0;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.LineLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return sn},e.prototype.mappingLayer=function(t,e){an(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&0!==t.length){var e=Eo(t);return e}return[]},e.DefaultOptions=sn,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(ln),e}(oo),cn=["color","size","style","state","animate"],un=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=pn.LayerType.PathLayer,e}return st(e,t),e.prototype.getDefaultOptions=function(){return Ke({},pn.DefaultOptions,{shape:"line"})},e.LayerOptionsKeys=pn.LayerConfigkeys.concat(cn),e}(pn),yn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Path,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.pathLayer=new un(lt({source:t},nt(this.options,un.LayerOptionsKeys)));var e=new Qe([this.pathLayer]);return e},e.prototype.updateLayers=function(t){var e=nt(t,un.LayerOptionsKeys);this.pathLayer.update(e)},e.prototype.getLegendOptions=function(){var t=this.pathLayer.getColorLegendItems();return 0!==t.length?{type:"category",items:t}:{}},e.DefaultOptions=rn,e}(co),hn=Ke({},co.DefaultOptions,{source:{data:[],parser:{type:"json"}},shape:"arc"}),dn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=pn.LayerType.ArcLayer,e}return st(e,t),e.prototype.getDefaultOptions=function(){return Ke({},pn.DefaultOptions,{shape:"arc"})},e}(pn),fn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Flow,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.flowLayer=new dn(lt({name:"flowLayer",source:t},nt(this.options,dn.LayerOptionsKeys)));var e=new Qe([this.flowLayer]);return this.options.radiation&&(this.radiationLayer=this.createRadiationLayer(t),e.addLayer(this.radiationLayer)),this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label),e.addLayer(this.labelLayer)),e},e.prototype.parserPointData=function(t){var e=[];return t.data.dataArray.forEach((function(t){var o=t.coordinates,n=yt(o,2),i=n[1];e.push(lt(lt({},t),{coordinates:i}))})),e},e.prototype.createRadiationLayer=function(t){var e=this,o=this.parserPointData(t),n=this.options.radiation||{},i=n.enabled,r=void 0===i||i,a=n.color,s=n.size,l=void 0===s?20:s,p=n.shape,c=void 0===p?"circle":p,u=n.animate,y=void 0===u||u,h=new zo({name:"radiationLayer",source:{data:o,parser:{type:"json",coordinates:"coordinates"}},visible:r,color:a,size:l,shape:c,animate:y}),d=function(){var t=e.parserPointData(e.source);h.layer.setData(t)};return t.on("update",d),h.on("remove",(function(){t.off("update",d)})),h},e.prototype.createLabelLayer=function(t,e){var o=this,n=this.parserPointData(t),i=this.options,r=i.visible,a=i.minZoom,s=i.maxZoom,l=i.zIndex,p=void 0===l?0:l,c=new lo(lt({name:"labelLayer",source:{data:n,parser:{type:"json",coordinates:"coordinates"}},visible:r,minZoom:a,maxZoom:s,zIndex:p+.1},e)),u=function(){var t=o.parserPointData(o.source);c.layer.setData(t)};return t.on("update",u),c.on("remove",(function(){t.off("update",u)})),c},e.prototype.updateLayers=function(t){var e=nt(t,dn.LayerOptionsKeys);if(this.flowLayer.update(e),t.radiation)if(this.radiationLayer){var o=lt(lt({},t.radiation),{visible:t.radiation.enabled});this.radiationLayer.update(o)}else this.radiationLayer=this.createRadiationLayer(this.source),this.layerGroup.addLayer(this.radiationLayer);this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.prototype.getLegendOptions=function(){var t=this.flowLayer.getColorLegendItems();return 0!==t.length?{type:"category",items:t}:{}},e.DefaultOptions=hn,e}(co),mn=Ke({},co.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}}),vn="#2f54eb",gn={active:{fill:!1,stroke:vn,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:vn,lineWidth:1.5,lineOpacity:.8}},Ln=function(t){return R(t)||(!1===t.active?gn.active=Object.assign(gn.active,{fill:!1,stroke:!1}):"object"===typeof t.active&&(!1===t.active.fill?gn.active.fill=!1:"string"===typeof t.active.fill&&(gn.active.fill=t.active.fill),!1===t.active.stroke?gn.active.stroke=!1:"string"===typeof t.active.stroke&&(gn.active.stroke=t.active.stroke),"number"===typeof t.active.lineWidth&&(gn.active.lineWidth=t.active.lineWidth),"number"===typeof t.active.lineOpacity&&(gn.active.lineOpacity=t.active.lineOpacity)),!1===t.select?gn.select=Object.assign(gn.select,{fill:!1,stroke:!1}):"object"===typeof t.select&&(!1===t.select.fill?gn.select.fill=!1:"string"===typeof t.select.fill&&(gn.select.fill=t.select.fill),!1===t.select.stroke?gn.select.stroke=!1:"string"===typeof t.select.stroke&&(gn.select.stroke=t.select.stroke),"number"===typeof t.select.lineWidth&&(gn.select.lineWidth=t.select.lineWidth),"number"===typeof t.select.lineOpacity&&(gn.select.lineOpacity=t.select.lineOpacity))),gn};function Cn(t,e,o,n,i,r){var a=r.color,s=r.style,l=r.state,p=Ln(l),c={active:!1!==p.active.fill&&{color:p.active.fill},select:!1},u={opacity:null===s||void 0===s?void 0:s.opacity},y=null===s||void 0===s?void 0:s.lineWidth,h=null===s||void 0===s?void 0:s.stroke,d={opacity:null===s||void 0===s?void 0:s.lineOpacity,dashArray:null===s||void 0===s?void 0:s.lineDash,lineType:null===s||void 0===s?void 0:s.lineType};if(io.shape(t,"fill"),a&&io.color(t,a),u&&io.style(t,u),c&&io.state(t,c),io.shape(e,"line"),y&&io.size(e,y),h&&io.color(e,h),d&&io.style(e,d),p.active.stroke){var f=p.active.stroke,m=p.active.lineWidth||y,v={opacity:p.active.lineOpacity};io.shape(o,"line"),m&&io.size(o,m),f&&io.color(o,f),v&&io.style(o,v)}if(p.select.fill){var g=p.select.fill;io.shape(n,"fill"),g&&io.color(n,g),u&&io.style(n,u),io.state(n,{select:!1,active:!1})}if(p.select.stroke){var L=p.select.stroke,C=(m=p.select.lineWidth||y,{opacity:p.select.lineOpacity});io.shape(i,"line"),m&&io.size(i,m),L&&io.color(i,L),C&&io.style(i,C)}}var bn={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},Dn=["color","style","state","enabledMultiSelect"],xn=function(t){function e(e){var o=t.call(this,e)||this;o.selectData=[],o.type=oo.LayerType.AreaLayer,o.interaction=!0,o.onHighlighHandle=function(t){var e=t.feature,n=t.featureId;o.setHighlightLayerSource(e,n)},o.onUnhighlighHandle=function(){o.setHighlightLayerSource()},o.onSelectHandle=function(t){var e=o.options.enabledMultiSelect,n=t.feature,i=t.featureId,r=K(o.selectData),a=r.findIndex((function(t){return t.featureId===i}));if(-1===a)e?r.push({feature:n,featureId:i}):r=[{feature:n,featureId:i}],o.emit("select",n,K(r));else{var s=r[a];e?r.splice(a,1):r=[],o.emit("unselect",s,K(r))}o.setSelectLayerSource(r)};var n=o.options,i=n.name,r=n.source,a=n.visible,s=n.minZoom,l=n.maxZoom,p=n.zIndex,c=void 0===p?0:p,u=o.pickLayerConfig(o.options),y=Ln(o.options.state);return o.name=i||rt(o.type),o.layer=new Gt.PolygonLayer(lt(lt({},u),{name:o.name})),o.strokeLayer=new Gt.LineLayer({name:"strokeLayer",visible:a,zIndex:c,minZoom:s,maxZoom:l}),o.highlightLayer=new Gt.LineLayer({name:"highlightLayer",visible:a&&Boolean(y.active.stroke),zIndex:c+.1,minZoom:s,maxZoom:l}),o.selectFillLayer=new Gt.PolygonLayer({name:"selectFillLayer",visible:a&&Boolean(y.select.fill),zIndex:c+.1,minZoom:s,maxZoom:l}),o.selectStrokeLayer=new Gt.LineLayer({name:"selectStrokeLayer",visible:a&&Boolean(y.select.stroke),zIndex:c+.1,minZoom:s,maxZoom:l}),o.mappingLayer(o.options),o.setSource(r),o.initEvent(),o}return st(e,t),e.prototype.getDefaultOptions=function(){return bn},e.prototype.mappingLayer=function(t){Cn(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,t)},e.prototype.setSource=function(e){t.prototype.setSource.call(this,e),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})},e.prototype.setStrokeLayerSource=function(){var t=this.layer.getSource();if(t)this.strokeLayer.setSource(t);else{var e=this.layer.sourceOption,o=e.data,n=e.options;this.strokeLayer.source(o,n)}},e.prototype.setHighlightLayerSource=function(t,e){if(void 0===e&&(e=-999),this.highlightLayerData!==e){var o=t?[t]:[];this.highlightLayer.setData({type:"FeatureCollection",features:o},{parser:{type:"geojson"}}),this.highlightLayerData=e}},e.prototype.setSelectLayerSource=function(t){if(void 0===t&&(t=[]),this.selectData.length!==t.length||!tt(this.selectData.map((function(t){var e=t.featureId;return e})),t.map((function(t){var e=t.featureId;return e})))){var e=t.map((function(t){var e=t.feature;return e}));this.selectFillLayer.setData({type:"FeatureCollection",features:e},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:e},{parser:{type:"geojson"}}),this.selectData=t}},e.prototype.initEvent=function(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))},e.prototype.addTo=function(t){t.addLayer(this.layer),t.addLayer(this.strokeLayer),t.addLayer(this.highlightLayer),t.addLayer(this.selectFillLayer),t.addLayer(this.selectStrokeLayer)},e.prototype.remove=function(t){t.removeLayer(this.layer),t.removeLayer(this.strokeLayer),t.removeLayer(this.highlightLayer),t.removeLayer(this.selectFillLayer),t.removeLayer(this.selectStrokeLayer)},e.prototype.update=function(e){if(t.prototype.update.call(this,e),this.mappingLayer(this.options),this.options.visible){R(e.state)||tt(this.lastOptions.state,this.options.state)||this.updateHighlightLayer();var o=Ln(this.options.state);o.active.stroke&&this.setHighlightLayerSource(),(o.select.fill||o.select.stroke)&&this.setSelectLayerSource()}this.initEvent()},e.prototype.updateHighlightLayer=function(){var t=Ln(this.options.state),e=Ln(this.lastOptions.state);e.active.stroke!==t.active.stroke&&(t.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),e.select.fill!==t.select.fill&&(t.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),e.select.stroke!==t.select.stroke&&(t.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},e.prototype.setIndex=function(t){this.layer.setIndex(t),this.strokeLayer.setIndex(t),this.highlightLayer.setIndex(t+.1),this.selectFillLayer.setIndex(t+.1),this.selectStrokeLayer.setIndex(t+.1)},e.prototype.setMinZoom=function(t){this.layer.setMinZoom(t),this.strokeLayer.setMinZoom(t),this.highlightLayer.setMinZoom(t),this.selectFillLayer.setMinZoom(t),this.selectStrokeLayer.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.layer.setMaxZoom(t),this.strokeLayer.setMaxZoom(t),this.highlightLayer.setMaxZoom(t),this.selectFillLayer.setMaxZoom(t),this.selectStrokeLayer.setMaxZoom(t)},e.prototype.show=function(){this.layer.inited&&(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())},e.prototype.hide=function(){this.layer.inited&&(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())},e.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&0!==t.length){var e=Eo(t);return e}return[]},e.prototype.setActive=function(t){},e.prototype.setSelect=function(t){},e.DefaultOptions=bn,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(Dn),e}(oo),Sn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Area,e}return st(e,t),e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.createLayers=function(t){this.areaLayer=new xn(lt({source:t},nt(this.options,xn.LayerOptionsKeys)));var e=new Qe([this.areaLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label,this.options),e.addLayer(this.labelLayer)),e},e.prototype.updateLayers=function(t){var e=nt(t,xn.LayerOptionsKeys);this.areaLayer.update(e),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.prototype.initLayersEvent=function(){},e.prototype.getLegendOptions=function(){var t=this.areaLayer.getColorLegendItems();return 0!==t.length?{type:"category",items:t}:{}},e.DefaultOptions=mn,e}(co),Fn=new Map;function On(t,e){Fn.set(t,e)}function wn(t){return Fn.get(t)}var kn=Ke({},co.DefaultOptions,{source:{data:[],joinBy:{geoField:"adcode"}},viewLevel:{level:"country",adcode:"100000"},chinaBorder:!0}),Tn={world:"country",country:"province",province:"city",city:"district",district:"district"},En="https://gw.alipayobjects.com/os/alisis/geo-data-v0.1.2",In="".concat(En,"/choropleth-data"),Bn={national:{color:"red",width:1,opacity:1},dispute:{color:"red",width:1,opacity:.8,dashArray:[2,4]},coast:{color:"blue",width:.7,opacity:.8},hkm:{color:"gray",width:.7,opacity:.8,dashArray:[2,4]}};function zn(t,e){var o,n=t.length,i=n-e;while(i<--n)o=t[i],t[i++]=t[n],t[n]=o}function An(t){return t}function jn(t){if(null==t)return An;var e,o,n=t.scale[0],i=t.scale[1],r=t.translate[0],a=t.translate[1];return function(t,s){s||(e=o=0);var l=2,p=t.length,c=new Array(p);c[0]=(e+=t[0])*n+r,c[1]=(o+=t[1])*i+a;while(l<p)c[l]=t[l],++l;return c}}function Hn(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return _n(t,e)}))}:_n(t,e)}function _n(t,e){var o=e.id,n=e.bbox,i=null==e.properties?{}:e.properties,r=Pn(t,e);return null==o&&null==n?{type:"Feature",properties:i,geometry:r}:null==n?{type:"Feature",id:o,properties:i,geometry:r}:{type:"Feature",id:o,bbox:n,properties:i,geometry:r}}function Pn(t,e){var o=jn(t.transform),n=t.arcs;function i(t,e){e.length&&e.pop();for(var i=n[t<0?~t:t],r=0,a=i.length;r<a;++r)e.push(o(i[r],r));t<0&&zn(e,a)}function r(t){return o(t)}function a(t){for(var e=[],o=0,n=t.length;o<n;++o)i(t[o],e);return e.length<2&&e.push(e[0]),e}function s(t){var e=a(t);while(e.length<4)e.push(e[0]);return e}function l(t){return t.map(s)}function p(t){var e,o=t.type;switch(o){case"GeometryCollection":return{type:o,geometries:t.geometries.map(p)};case"Point":e=r(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(r);break;case"LineString":e=a(t.arcs);break;case"MultiLineString":e=t.arcs.map(a);break;case"Polygon":e=l(t.arcs);break;case"MultiPolygon":e=t.arcs.map(l);break;default:return null}return{type:o,coordinates:e}}return p(e)}var Mn=function(t){var e={url:In,type:"topojson",extension:"topo.json"};return R(t)||("string"===typeof t?e.url=t:(e.url=(null===t||void 0===t?void 0:t.url)||In,e.type=t.type,e.extension="topojson"===t.type?"topo.json":"json")),e},Zn=function(t){try{var e=Hn(t,"json");return e}catch(o){throw new Error('Failed convert to geojson from topojson, topojson default layer name "json"')}},Nn=function(t,e){if(t.length!==e.length)return!1;for(var o=0;o<t.length;o++){var n=t[o],i=n.level,r=n.granularity;if(e[o].level!==i||e[o].granularity!==r)return!1}return!0},Gn=function(t){var e=nt(t,["source","color","style","state","label","tooltip"]);return e},Rn=function(t,e){var o=e||{},n=o.visible,i=o.minZoom,r=o.maxZoom,a=o.zIndex,s=void 0===a?0:a,l=o.chinaBorder,p="object"===typeof l?Ke({},Bn,l):Bn,c=t.features.filter((function(t){var e=t.properties;return["coast","national"].includes(null===e||void 0===e?void 0:e["type"])})),u=t.features.filter((function(t){var e=t.properties;return"dispute"===(null===e||void 0===e?void 0:e["type"])})),y=t.features.filter((function(t){var e=t.properties;return"hkm"===(null===e||void 0===e?void 0:e["type"])})),h=new un({name:"chinaBoundaryLayer",visible:n,minZoom:i,maxZoom:r,zIndex:s+.1,source:{data:{type:"FeatureCollection",features:c},parser:{type:"geojson"}},color:{field:"type",value:function(t){var e=t.type;return p[e].color}},size:{field:"type",value:function(t){var e=t.type;return p[e].width}},style:{opacity:p.national.opacity}}),d=new un({name:"chinaHkmBoundaryLayer",visible:n,minZoom:i,maxZoom:r,zIndex:s+.1,source:{data:{type:"FeatureCollection",features:y},parser:{type:"geojson"}},color:p.hkm.color,size:p.hkm.width,style:{opacity:p.hkm.opacity,lineType:"dash",dashArray:p.hkm.dashArray}}),f=new un({name:"chinaDisputeBoundaryLayer",visible:n,minZoom:i,maxZoom:r,zIndex:s+.1,source:{data:{type:"FeatureCollection",features:u},parser:{type:"geojson"}},color:p.dispute.color,size:p.dispute.width,style:{opacity:p.dispute.opacity,lineType:"dash",dashArray:p.dispute.dashArray}});return{chinaBoundaryLayer:h,chinaHkmBoundaryLayer:d,chinaDisputeBoundaryLayer:f}},Vn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=co.PlotType.Choropleth,e.chinaBoundaryData={type:"FeatureCollection",features:[]},e.currentDistrictData={type:"FeatureCollection",features:[]},e.drillSteps=[],e.drillStacks=[],e.onDrillDownHander=function(t){var o,n=e.options.drill,i=n.steps,r=n.onDown,a=null===(o=t.feature)||void 0===o?void 0:o.properties,s=a.adcode;if(e.drillStacks.length!==i.length+1){var l=e.drillStacks.slice(-1)[0],p=e.drillStacks.length-1,c=e.drillSteps[p],u=c.level,y=c.granularity,h=void 0===y?Tn[u]:y,d=pt(c,["level","granularity"]),f={nativeEvent:!0,from:{level:l.level,adcode:l.adcode,granularity:l.granularity},to:{level:u,adcode:s,granularity:h,properties:a}},m=function(t){void 0===t&&(t={});var o={level:u,adcode:s,granularity:h},n=Ke({},d,t);e.changeView(o,n).then((function(t){t&&(e.drillStacks.push(t),e.emit("drilldown",f))}))};r?r(f.from,f.to,m):m()}},e.onDrillUpHander=function(){var t=e.options.drill.onUp,o=0===e.drillStacks.length||1===e.drillStacks.length;if(!o){var n=e.drillStacks.length-1,i=e.drillStacks[n],r=e.drillStacks[n-1],a={nativeEvent:!0,from:{level:i.level,adcode:i.adcode,granularity:i.granularity},to:{level:r.level,adcode:r.adcode,granularity:r.granularity}},s=function(t){void 0===t&&(t={});var o=a.to,n=Ke({},r.config,t);e.changeView(o,n).then((function(t){t&&(e.drillStacks.pop(),e.emit("drillup",a))}))};t?t(a.from,a.to,s):s()}},e}return st(e,t),e.prototype.initSource=function(){var t=this;this.getInitDistrictData().then((function(){t.source=t.createSource(),t.render(),t.inited=!0}))},e.prototype.render=function(){var t=this;if(this.inited)this.scene.setEnableRender(!0),this.scene.render();else{var e=this.createLayers(this.source);this.layerGroup=e,this.scene["sceneService"].loaded?this.onSceneLoaded():this.scene.once("loaded",(function(){t.onSceneLoaded()})),this.initLayersEvent()}},e.prototype.update=function(t){var e,o,n,i=this;if(this.updateOption(t),t.map&&!tt(this.lastOptions.map,this.options.map)&&this.updateMap(t.map),t.drill&&!1!==t.drill.enabled&&!tt(null===(e=this.lastOptions.drill)||void 0===e?void 0:e.steps,null===(o=this.options.drill)||void 0===o?void 0:o.steps)&&(this.drillReset(),this.initDrillEvent()),this.scene.setEnableRender(!1),t.viewLevel&&!tt(this.lastOptions.viewLevel,this.options.viewLevel)){var r=null===(n=t.source)||void 0===n?void 0:n.joinBy.geoData;this.getDistrictData(r).then((function(){var e=i.options.source,o=e.data,n=pt(e,["data"]);i.changeData(o,n),i.updateLayers(t),i.render(),i.updateComponents(),i.emit("update")}))}else{if(t.source&&!tt(this.lastOptions.source,this.options.source)){var a=this.options.source,s=a.data,l=pt(a,["data"]);this.changeData(s,l)}this.updateLayers(t),this.render(),this.updateComponents(),this.emit("update")}},e.prototype.getDefaultOptions=function(){return e.DefaultOptions},e.prototype.parserSourceConfig=function(t){var e=t.data,o=t.joinBy,n=pt(t,["data","joinBy"]),i=o.sourceField,r=o.geoField,a=o.geoData,s=a,l={type:"join",sourceField:i,targetField:r,data:e};return n.transforms?n.transforms.push(l):n.transforms=[l],n["parser"]&&delete n["parser"],{data:s,sourceCFG:n}},e.prototype.createSource=function(){var t=this.parserSourceConfig(this.options.source),e=t.data,o=t.sourceCFG,n=new Gt.Source(e,o);return n},e.prototype.changeData=function(t,e){var o=this;this.options.source=Ke({},this.options.source,lt({data:t},e));var n=this.parserSourceConfig(this.options.source),i=n.data,r=n.sourceCFG;this.source.setData(i,r);var a=this.options.legend;a&&setTimeout((function(){o.updateLegendControl(a)})),this.emit("change-data")},e.prototype.createLayers=function(t){this.fillAreaLayer=new xn(lt({name:"fillAreaLayer",source:t},nt(this.options,xn.LayerOptionsKeys)));var e=new Qe([this.fillAreaLayer]);if(this.options.chinaBorder){var o=this.createCountryBoundaryLayer(this.chinaBoundaryData,this.options);o.forEach((function(t){return e.addLayer(t)}))}return this.options.label&&(this.labelLayer=this.createLabelLayer(t,this.options.label),e.addLayer(this.labelLayer)),e},e.prototype.createCountryBoundaryLayer=function(t,e){var o=Rn(t,e),n=o.chinaBoundaryLayer,i=o.chinaHkmBoundaryLayer,r=o.chinaDisputeBoundaryLayer;return this.chinaBoundaryLayer=n,this.chinaHkmBoundaryLayer=i,this.chinaDisputeBoundaryLayer=r,[n,i,r]},e.prototype.createLabelLayer=function(t,e){var o=this,n=t["originData"].features.map((function(t){var e=t.properties;return Object.assign({},e,{centroid:e["centroid"]||e["center"]})})).filter((function(t){var e=t.centroid;return e})),i=this.options,r=i.visible,a=i.minZoom,s=i.maxZoom,l=i.zIndex,p=void 0===l?0:l,c=new lo(lt({name:"labelLayer",source:{data:n,parser:{type:"json",coordinates:"centroid"},transforms:t.transforms},visible:r,minZoom:a,maxZoom:s,zIndex:p+.1},e)),u=function(){var e=o.source["originData"].features.map((function(t){var e=t.properties;return e})).filter((function(t){var e=t.centroid;return e}));c.layer.setData(e,{transforms:t.transforms})};return t.on("update",u),c.on("remove",(function(){t.off("update",u)})),c},e.prototype.updateLayers=function(t){var e=this,o=nt(t,xn.LayerOptionsKeys);this.fillAreaLayer.update(o);var n=function(){var t=e.createCountryBoundaryLayer(e.chinaBoundaryData,e.options);t.forEach((function(t){return e.layerGroup.addLayer(t)}))},i=function(){e.chinaBoundaryLayer&&e.layerGroup.removeLayer(e.chinaBoundaryLayer),e.chinaHkmBoundaryLayer&&e.layerGroup.removeLayer(e.chinaHkmBoundaryLayer),e.chinaDisputeBoundaryLayer&&e.layerGroup.removeLayer(e.chinaDisputeBoundaryLayer)};t.chinaBorder?this.chinaBoundaryLayer?(i(),n()):n():!1===t.chinaBorder&&i(),this.updateLabelLayer(this.source,t.label,this.options,this.labelLayer)},e.prototype.initLayersEvent=function(){this.initDrillEvent()},e.prototype.initDrillEvent=function(){if(this.lastOptions.drill){var t=this.lastOptions.drill,e=t.triggerUp,o=void 0===e?"unclick":e,n=t.triggerDown,i=void 0===n?"click":n;this.fillAreaLayer.off(o,this.onDrillUpHander),this.fillAreaLayer.off(i,this.onDrillDownHander)}if(this.options.drill&&!1!==this.options.drill.enabled){var r=this.options.drill,a=r.steps,s=r.triggerUp,l=void 0===s?"unclick":s,p=r.triggerDown,c=void 0===p?"click":p,u=a.map((function(t){return"string"===typeof t?{level:t,granularity:Tn[t]}:(t.granularity||(t.granularity=Tn[t.level]),t)}));if(Nn(u,this.drillSteps)||(this.drillSteps=u,this.drillStacks=[]),!this.drillStacks.length){var y=this.options.viewLevel,h=y.level,d=y.adcode,f=y.granularity,m=void 0===f?Tn[h]:f,v=Gn(this.options);this.drillStacks=[{level:h,adcode:d,granularity:m,config:v}]}this.fillAreaLayer.on(l,this.onDrillUpHander),this.fillAreaLayer.on(c,this.onDrillDownHander)}},e.prototype.drillReset=function(){this.drillStacks=[]},e.prototype.getCurrentDrillSteps=function(){var t=this.drillStacks.map((function(t){return nt(t,["level","adcode","granularity"])}));return t},e.prototype.getLegendOptions=function(){var t=this.fillAreaLayer.getColorLegendItems();return 0!==t.length?{type:"category",items:t}:{}},e.prototype.fetchData=function(t,e,o){return ct(this,void 0,void 0,(function(){var n,i,r,a,s,l,p,c,u;return ut(this,(function(y){switch(y.label){case 0:return n="".concat(e,"_").concat(t,"_").concat(o),i=wn(n),i?[2,i]:(r=Mn(this.options.geoArea),a=r.url,s=r.type,l=r.extension,c=this.options.customFetchGeoData,c?[4,c({url:a,level:t,adcode:e,granularity:o,extension:l})]:[3,2]);case 1:return p=y.sent(),[3,5];case 2:return[4,fetch("".concat(a,"/").concat(t,"/").concat(n,".").concat(l))];case 3:return u=y.sent(),[4,u.json()];case 4:p=y.sent(),y.label=5;case 5:return"topojson"===s&&(p=Zn(p)),On(n,p),[2,p]}}))}))},e.prototype.getInitDistrictData=function(){var t;return ct(this,void 0,void 0,(function(){var e,o,n,i;return ut(this,(function(r){switch(r.label){case 0:e=this.fetchData("country","100000","boundary"),o=null===(t=this.options.source)||void 0===t?void 0:t.joinBy.geoData,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Promise.all([e,this.getDistrictData(o)])];case 2:return i=yt.apply(void 0,[r.sent(),1]),this.chinaBoundaryData=i[0],[3,4];case 3:throw n=r.sent(),new Error("Failed to get china boundary data\uff0c".concat(n));case 4:return[2]}}))}))},e.prototype.getDistrictData=function(t){return ct(this,void 0,void 0,(function(){var e,o,n,i,r,a,s,l;return ut(this,(function(p){switch(p.label){case 0:e=this.options.viewLevel,o=e.level,n=e.adcode,i=e.granularity,r=void 0===i?Tn[o]:i,a=t?Promise.resolve(t):this.fetchData(o,n,r),p.label=1;case 1:return p.trys.push([1,3,,4]),s=this,[4,a];case 2:return s.currentDistrictData=p.sent(),this.options.source=Ke({},this.options.source,{joinBy:{geoData:this.currentDistrictData}}),[3,4];case 3:throw l=p.sent(),new Error("Failed to get district data\uff0c".concat(l));case 4:return[2]}}))}))},e.prototype.drillDown=function(t,e){var o=this;void 0===e&&(e={});var n=this.drillStacks.slice(-1)[0],i=t.level,r=t.adcode,a=t.granularity,s={nativeEvent:!1,from:{level:n.level,adcode:n.adcode,granularity:n.granularity},to:{level:i,adcode:r,granularity:a}};this.changeView(t,e).then((function(t){t&&(o.drillStacks.push(t),o.emit("drilldown",s))}))},e.prototype.drillUp=function(t,e){var o=this;void 0===t&&(t={});var n=this.drillStacks.length,i=[0,1].includes(n);if(!i){var r=e?this.drillStacks.findIndex((function(t){return t.level===e})):-1,a=-1!==r,s=a?r:n-2,l=this.drillStacks[s],p=l.config,c=pt(l,["config"]),u=Ke({},p,t),y=this.drillStacks[this.drillStacks.length-1],h={nativeEvent:!1,from:{level:y.level,adcode:y.adcode,granularity:y.granularity},to:{level:c.level,adcode:c.adcode,granularity:c.granularity}};this.changeView(c,u).then((function(t){t&&(a?o.drillStacks.splice(r+1):o.drillStacks.pop(),o.emit("drillup",h))}))}},e.prototype.changeView=function(t,e){return void 0===e&&(e={}),ct(this,void 0,void 0,(function(){var o,n,i,r,a,s,l;return ut(this,(function(p){switch(p.label){case 0:return o=t.level,n=t.adcode,i=t.granularity,r=void 0===i?Tn[o]:i,[4,this.fetchData(o,n,r)];case 1:return a=p.sent(),a.features.length?(s=Ke({},Gn(this.options),e,{viewLevel:{level:o,adcode:n,granularity:r},source:{joinBy:{geoData:a}}}),this.update(s),l={level:o,adcode:n,granularity:r,config:s},[2,l]):[2]}}))}))},e.DefaultOptions=kn,e.GeoDataUrl=En,e.GeoAreaUrl=In,e}(co),Kn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=zo.LayerType.IconLayer,e}return st(e,t),e.prototype.getDefaultOptions=function(){return Ke({},zo.DefaultOptions,{color:void 0})},e}(zo),Un=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=zo.LayerType.ColumnLayer,e}return st(e,t),e.prototype.getDefaultOptions=function(){return Ke({},zo.DefaultOptions,{shape:"cylinder"})},e}(zo);function Wn(t,e){var o=e.color,n=e.size,i=e.style,r=e.state;io.shape(t,"extrude"),n&&io.size(t,n),o&&io.color(t,o),i&&io.style(t,i),r&&io.state(t,r)}var Qn,qn,Yn={},Xn=["color","size","style","state"],$n=function(t){function e(e){var o=t.call(this,e)||this;o.type=oo.LayerType.PrismLayer,o.interaction=!0;var n=o.options,i=n.name,r=n.source,a=o.pickLayerConfig(o.options);return o.name=i||rt(o.type),o.layer=new Gt.PolygonLayer(lt(lt({},a),{name:o.name})),o.mappingLayer(o.layer,o.options),o.setSource(r),o}return st(e,t),e.prototype.getDefaultOptions=function(){return Yn},e.prototype.mappingLayer=function(t,e){Wn(t,e)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.mappingLayer(this.layer,this.options)},e.prototype.getColorLegendItems=function(){var t=this.layer.getLegendItems("color");if(Array.isArray(t)&&0!==t.length){var e=Eo(t);return e}return[]},e.DefaultOptions=Yn,e.LayerOptionsKeys=oo.LayerConfigkeys.concat(Xn),e}(oo),Jn=(Qn={},Qn[Ht.Dot]=Ao,Qn[Ht.DotDensity]=Po,Qn[Ht.Heatmap]=Ko,Qn[Ht.Grid]=Xo,Qn[Ht.Hexbin]=nn,Qn[Ht.Path]=yn,Qn[Ht.Flow]=fn,Qn[Ht.Area]=Sn,Qn[Ht.Choropleth]=Vn,Qn),ti=(qn={},qn[At.TextLayer]=lo,qn[At.DotLayer]=zo,qn[At.IconLayer]=Kn,qn[At.DotDensity]=_o,qn[At.ColumnLayer]=Un,qn[At.HeatmapLayer]=Vo,qn[At.GridLayer]=Yo,qn[At.HexbinLayer]=on,qn[At.PathLayer]=un,qn[At.ArcLayer]=dn,qn[At.AreaLayer]=xn,qn[At.PrismLayer]=$n,qn),ei={},oi=function(t){function e(e,o){var n=t.call(this,o)||this;return n.plots=[],n.container=n.createContainer(e),n.theme=n.createTheme(),n.scene=n.createScene(),n.registerResources(),n.render(),n.inited=!0,n}return st(e,t),e.prototype.getDefaultOptions=function(){return Ke({},Je.DefaultOptions,e.DefaultOptions)},e.prototype.createLayers=function(){for(var t=new Qe([]),e=this.options.layers||[],o=0;o<e.length;o++){var n=this.createLayer(e[o]);t.addLayer(n)}return t},e.prototype.createLayer=function(t){var e=t.type,o=pt(t,["type"]),n=ti[e];if(R(n))throw new Error("Don't exist ".concat(e," layer"));var i=new n(o);return i},e.prototype.addLayer=function(e){var o=function(t){return"function"===typeof t["render"]};if(o(e))t.prototype.addLayer.call(this,e);else{var n=this.createLayer(e);t.prototype.addLayer.call(this,n)}},e.prototype.removeLayerByName=function(t){var e=this.layerGroup.getLayerByName(t);return!!e&&this.layerGroup.removeLayer(e)},e.prototype.updateLayers=function(t){},e.prototype.updatePlots=function(t){},e.prototype.render=function(){var t=this,e=this.createLayers();this.inited?(this.layerGroup.removeAllLayer(),e.addTo(this.scene),this.layerGroup=e,this.updateControls()):(this.layerGroup=e,this.scene["sceneService"].loaded?this.onSceneLoaded():this.scene.once("loaded",(function(){t.onSceneLoaded()})))},e.prototype.onSceneLoaded=function(){var t=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",(function(){t.onLayersLoaded()})),this.layerGroup.addTo(this.scene)},e.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.renderPlots(),this.initControls(),this.loaded=!0,this.emit("loaded")},e.prototype.renderPlots=function(){for(var t=this.options.plots||[],e=0;e<t.length;e++){var o=t[e],n=this.createPlot(o);this.plots.push(n)}},e.prototype.createPlot=function(t){var e=t.type,o=(t.legend,t.layerMenu,pt(t,["type","legend","layerMenu"])),n=Jn[e];if(R(n))throw new Error("Don't exist ".concat(e," plot"));var i=new n(o);return i.attachToScene(this.scene,this.theme),i},e.prototype.addPlot=function(t){var e=this.createPlot(t);this.plots.push(e)},e.prototype.getPlots=function(){return this.plots},e.prototype.getPlotByName=function(t){return this.plots.find((function(e){var o;return(null===(o=e.options)||void 0===o?void 0:o.name)===t}))},e.prototype.removePlotByName=function(t){var e=this.plots.findIndex((function(e){var o;return(null===(o=e.options)||void 0===o?void 0:o.name)===t}));if(-1===e)return!1;var o=yt(this.plots.splice(e,1),1),n=o[0];return n.unattachFromScene(),!0},e.prototype.removeAllPlot=function(){this.plots.forEach((function(t){t.unattachFromScene()})),this.plots=[]},e.DefaultOptions=ei,e}(Je)}}]);
//# sourceMappingURL=561.f2cba991.async.js.map