"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}define("BaseWaterfallchart",["Utility","model/Component","ui/extendIconUI","echartbase/BaseBarchart","Base.Panel","utility/colors","echartbase/EchartsBase","echartbase/EchartsBase.Panel","render/Base"],(function(e,t,r,o,n,a,i,l,s){var c=new n,u="BaseWaterfallchart",p=i.getLocaleFn(["components","extends",u]),m=i.extend({type:u,name:p("name"),description:p("desc"),echartsInit:function(){this.options=Object.assign({},i.getBaseOption(),{extend_properties:{accumulation:false},legend:{show:!1},yAxis:{type:"value",show:!0},xAxis:{show:!0,axisLine:{show:!0},axisTick:{show:!1},data:[],boundaryGap:!0,nameTextStyle:{}},series:[]})},checkQm:function(){return o.prototype.checkQm.apply(this,Array.from(arguments)),this.model.mslice(1),this},beforeQuery:function(e){var r=this.getCustomizeFunction("action","_preFetch"),o=new t({chartType:this.model.get("chartType"),query:e}),n=this.options.extend_properties||{},a=n.accumulation,i=n.accumulationName;return a&&o.tryTurnOnRowGrandsummary(),e=o.get("query"),a&&(e.properties["datafor.query.total.name"]=i||p("accumulation default label")),e=_.isFunction(r)?r.call(this,e):e},onExecuteJumpEvent:function(){return o.prototype.onExecuteJumpEvent.apply(this,Array.from(arguments))},render:function(){var e,t=this.options.extend_properties||{},r=t.accumulationColor,o=t.negativeColor,n=t.positiveColor,a=function(e){return e>=0?n:o};return null===(e=this.options.series)||void 0===e||e.forEach((function(e){var t;"PLACEHOLDER"===e.name?e.label={show:!1}:null===(t=e.data)||void 0===t||t.forEach((function(e){e.isGrand?(e.itemStyle=e.itemStyle||{},e.itemStyle.normal=e.itemStyle.normal||{},e.itemStyle.normal.color=r||a(e.originalValue)):(e.itemStyle=e.itemStyle||{},e.itemStyle.normal=e.itemStyle.normal||{},e.itemStyle.normal.color=a(e.originalValue))}))})),i.prototype.render.apply(this,arguments)},beforeSetHighlight:function(e,t){return o.prototype.beforeSetHighlight.apply(this,Array.from(arguments))},conditionSettingsResponse:function(){return o.prototype.conditionSettingsResponse.apply(this,Array.from(arguments))},dataFormatter:function(){var e=this,t=Array.prototype.slice.call(arguments)[4],r=void 0===t?{}:t,o=(null==r?void 0:r.json)||{},n=o.isEmpty,a=o.error,l=o.javaErr;if(n)return this.dataEmpty(),this;if(a||l)return this.dataErrorMessage(a||l),this;var s=Array.from(arguments);return this.doTask(_objectSpread({baseOptions:JSON.stringify(this.options),eventType:"dataFormat"},null==r?void 0:r.json),!0).then((function(t){var r=t.options;e.options=Object.assign(e.options,r),e.options.tooltip.formatter=function(t){var r=t.data;return r?e.buildTip(r.tip):null},r.series.forEach((function(e){var t;null!==(t=e.label)&&void 0!==t&&t.show&&(e.label.formatter=function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.formatted})})),e.options.tooltip.trigger="item",i.prototype.dataFormatter.apply(e,s)}))}},{thumbnail:"icon iconfont icon-datafor-donut-pie",_sort_order:26,logo:r.getGeneralIcon({},'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1" width="21" height="21" viewBox="0 0 21 21"><g><g><rect x="1" y="3" width="4" height="17" rx="0" fill="#096DD9" fill-opacity="1"/></g><g><rect x="11" y="1" width="4" height="6" rx="0" fill="#096DD9" fill-opacity="1"/></g><g><rect x="6" y="3" width="4" height="8" rx="0" fill="#FAAD14" fill-opacity="1"/></g><g><rect x="16" y="7" width="4" height="12" rx="0" fill="#FAAD14" fill-opacity="1"/></g></g></svg>',"0.85em"),privates:Object.assign({},i.privates,{skipBuildDetailObject:!0,isCoordinatedChart:!0}),menus:function(){return{outer:[{value:"DrillReset"},{value:"Enlarge"}],inner:[{value:"Export",children:[{value:"Excel"},{value:"Csv"},{value:"Image"}]},{value:"Preview"}]}},task:!0,symbol:function(){return"".concat(e.getWebAppName(),"/content/datafor/ui/extend_components/").concat(u,"/waterfall.svg?_t=").concat(e.getStartupTimestamp())},staticPanelOptions:_.extend([],[{name:"data",label:e.locale("panel","data"),active:!0,datasets:[c.datasource(),c.line(),c.enhanceDimensionPrimary(p("field"),null,1,p("field desc")),c.line(),c.measures(p("measure"),"single",!1,1,null,1,p("measure desc")),c.line()].concat(_toConsumableArray(c.getAxisLinkPanelGroup()),[c.filters()])},{name:"style",label:e.locale("panel","styles"),active:!1,datasets:[].concat(_toConsumableArray(c.getComponentCaptionGroup()),[c.line()],_toConsumableArray(c.getComponentFramesetGroup()),[c.line()],_toConsumableArray(l.getBarchartStyleGroup()),[c.line(),c.label(p("accumulation setting")),_.extend(s.getRendererBaseAttrs("RadioBox"),{name:"show.accumulation",tooltip:p("show accumulation"),value:false,label:p("show accumulation desc"),execute:function(e,t,r,o){t.extend_properties=Object.assign(t.extend_properties||{},{accumulation:!!e}),e!=o&&this.model.commit()}}),_.extend(s.getRendererBaseAttrs("TextInput"),{name:"accumulation.title",value:p("accumulation default label"),queried:!1,label:p("accumulation caption"),tooltip:p("accumulation caption desc"),execute:function(e,t,r,o){t.extend_properties=Object.assign(t.extend_properties||{},{accumulationName:e}),e!=o&&this.model.commit()}}),_.extend(s.getRendererBaseAttrs("ColorPicker"),{name:"accumulation.color",tooltip:p("accumulation color desc"),value:"#096DD9",label:p("accumulation color"),execute:function(e,t,r,o){t.extend_properties=Object.assign(t.extend_properties||{},{accumulationColor:e}),e!=o&&this.model.commit()}}),c.line(),c.label(e.locale("panel","style panel","universal","data color")),_.extend(s.getRendererBaseAttrs("ColorPicker"),{name:"positive.color",tooltip:p("positive color desc"),label:p("positive color"),execute:function(e,t,r,o){t.extend_properties=Object.assign(t.extend_properties||{},{positiveColor:e})},init:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.hasOwnProperty("style.positive.color")?t["style.positive.color"]:null===(o=__ENV)||void 0===o?void 0:o.colors[0];var o}}),_.extend(s.getRendererBaseAttrs("ColorPicker"),{name:"negative.color",tooltip:p("negative color desc"),label:p("negative color"),execute:function(e,t,r,o){t.extend_properties=Object.assign(t.extend_properties||{},{negativeColor:e})},init:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.hasOwnProperty("style.negative.color")?t["style.negative.color"]:null===(o=__ENV)||void 0===o?void 0:o.colors[1];var o}}),c.line()],_toConsumableArray(l.getDataPointLabelGroup(null,!0,null,a.dataLabelColor())),[c.line()],_toConsumableArray(l.getCategoriedAxisXGroup()),[c.line()],_toConsumableArray(l.getNormalValueAxisYGroup(null,!0,(function(){return this.model.getMeasures().trimSimiMeasures().map((function(e){return e.label})).join("~")}))),[c.line()],_toConsumableArray(l.getGridLineGroup()),[c.line()],_toConsumableArray(c.getComponentToolbarGroup()))},{name:"action",label:e.locale("panel","actions"),datasets:_toConsumableArray(l.getComponentActionEventGroup())}])});return i.register(m),m}));
//# sourceMappingURL=BaseWaterfallchart.js.map