"use strict";function _typeof2(t){return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof2(t)}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)},_typeof(t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var o,n,a,i,l=[],u=!0,c=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(o=a.call(r)).done)&&(l.push(o.value),l.length!==e);u=!0);}catch(t){c=!0,n=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return l}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _objectWithoutProperties(t,e){if(null==t)return{};var r,o,n=_objectWithoutPropertiesLoose(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)r=a[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var r,o,n={},a=Object.keys(t);for(o=0;o<a.length;o++)r=a[o],e.indexOf(r)>=0||(n[r]=t[r]);return n}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}self.onmessage=function(t){var e=t.data;"dataFormat"==e.eventType&&dataFormatter(e)};var dataFormatter=function(t){var e=t.columnLeafs,r=t.fields,o=t.dataArray,n=t.autoAdjust,a=t.color,i=t.columns,l=t.tooltips,u=void 0===l?[]:l,c=Object.values(e),y=r||{},f=y.lng,p=y.lat,s=y.type,m=y.name,d=y.measure,v=y.tooltip,b=[],h=[],_=[],A=[],S=[],g=[s,d].concat(_toConsumableArray(v.map((function(t){return t})))).filter((function(t){return!!t&&!t.match(/^\[Measures\]\.\[/)&&t.match(/^\[/)})),w=o.map((function(t,e){var r,o,n=t.geoLocation,l=t[f],y=t[p],v=t[s],w=t[m],j=t[d],M=t.datafor_rows,O=void 0===M?[]:M,T=_objectWithoutProperties(t,["geoLocation",f,p,s,m,d,"datafor_rows"].map(_toPropertyKey)),k=Object.keys(u[e]||{}).filter((function(t){return t.match(/^\[/)})).map((function(t){var r,o,n,a,i=String(t).replace(/\]\.\d+$/g,"]"),l=_slicedToArray(i.replace(/\]\.\d+$/g,"]").split("].[").map((function(t){return String(t).replace(/\[|\]/g,"")})),3),c=l[0],y=l[1];return l[2],{value:null===(r=u[e][t])||void 0===r?void 0:r.value,levelCaption:null===(o=u[e][t])||void 0===o?void 0:o.caption,uniqueName:null===(n=u[e][t])||void 0===n?void 0:n.value,uniquename:null===(a=u[e][t])||void 0===a?void 0:a.value,level:i,hierarchy:"[".concat(c,"].[").concat(y,"]"),axis:"dimMeasure",dimension:"".concat(c)}})),P={id:null==O?void 0:O.map((function(t){return t.uniqueName})).join("~"),typecode:(null==v?void 0:v.vtip)||(null==v?void 0:v.formatted)||(null==v?void 0:v.raw)||v||"--",address:w,location:m&&n?n:l&&y?[Number(l),Number(y)]:null,value:null!=j&&j.raw?Number(null==j?void 0:j.raw):0,formatted:(null==j?void 0:j.formatted)||(null==j?void 0:j.raw)||0,levels:null==O?void 0:O.map((function(t){return t})).concat(k),measures:null==c||null===(r=c.filter((function(t){return t.isMeasureNode})))||void 0===r?void 0:r.map((function(t){var e,r,o;return{caption:t.title,uniqueName:t.key,value:T.hasOwnProperty(t.key)?(null===(e=T[t.key])||void 0===e?void 0:e.raw)||T[t.key]:"",vtip:T.hasOwnProperty(t.key)?(null===(r=T[t.key])||void 0===r?void 0:r.vtip)||T[t.key]:"",formatted:T.hasOwnProperty(t.key)?(null===(o=T[t.key])||void 0===o?void 0:o.formatted)||T[t.key]:""}}))};return g.forEach((function(e){var r=t[e],o=_slicedToArray(e.split("].[").map((function(t){return String(t).replace(/\[|\]/g,"")})),2),n=o[0],a=o[1],l=i.find((function(t){return t.key===e}));if(r&&l){var u={value:r.vtip||r.formatted,levelCaption:l.title,uniqueName:r.uniqueName,uniquename:r.uniqueName,level:e,hierarchy:"[".concat(n,"].[").concat(a,"]"),axis:"dimMeasure",dimension:"".concat(n)};P.levels.find((function(t){return t.level==u.level}))||P.levels.push(u)}})),S.indexOf(P.typecode)<0&&S.push(P.typecode),P.location&&P.location[0]&&P.location[1]&&(_.push(P.location[0]),A.push(P.location[1])),h.push(P.value),P.mixed="".concat(P.id,":::").concat(a),P.typecodeMixed="".concat(P.id,":::").concat(P.typecode),null===(o=t.tip)||void 0===o||null===(o=o.rows)||void 0===o||o.forEach((function(t){var e=t.caption,r=t.value;P[e]=r,b.indexOf(e)<0&&b.push(e)})),P})),j=Math.min.apply(Math,h),M=Math.max.apply(Math,h);w.forEach((function(t){t.sizeRatio=M!=j&&j&&M?(t.value-j)/(M-j):1})),self.postMessage({eventType:"dataFormat",data:w.filter((function(t){var e=t.location;return Array.isArray(e)&&e[0]&&e[1]})),tipArray:b,typesArray:S,bounds:n?[[Math.min.apply(Math,_),Math.min.apply(Math,A)],[Math.max.apply(Math,_),Math.max.apply(Math,A)]]:null})};
//# sourceMappingURL=L7PlotMarker.js.map